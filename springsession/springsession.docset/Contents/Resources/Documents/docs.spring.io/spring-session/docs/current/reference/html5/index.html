<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<meta name="author" content="Rob Winch, Vedran PaviÄ‡">
<title>Spring Session</title>
<link rel="stylesheet" href="../../../../../../fonts.googleapis.com/css%3Ffamily=Open+Sans:300,300italic,400,400italic,600,600italic|Noto+Serif:400,400italic,700,700italic|Droid+Sans+Mono:400,700.css">
<style>article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}audio,canvas,video{display:inline-block}audio:not([controls]){display:none;height:0}[hidden],template{display:none}script{display:none!important}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}a{background:transparent}a:focus{outline:thin dotted}a:active,a:hover{outline:0}h1{font-size:2em;margin:.67em 0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:bold}dfn{font-style:italic}hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}mark{background:#ff0;color:#000}code,kbd,pre,samp{font-family:monospace;font-size:1em}pre{white-space:pre-wrap}q{quotes:"\201C" "\201D" "\2018" "\2019"}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:0}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}button,input{line-height:normal}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}textarea{overflow:auto;vertical-align:top}table{border-collapse:collapse;border-spacing:0}*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}html,body{font-size:100%}body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}a:hover{cursor:pointer}img,object,embed{max-width:100%;height:auto}object,embed{height:100%}img{-ms-interpolation-mode:bicubic}.left{float:left!important}.right{float:right!important}.text-left{text-align:left!important}.text-right{text-align:right!important}.text-center{text-align:center!important}.text-justify{text-align:justify!important}.hide{display:none}body{-webkit-font-smoothing:antialiased}img,object,svg{display:inline-block;vertical-align:middle}textarea{height:auto;min-height:50px}select{width:100%}.center{margin-left:auto;margin-right:auto}.spread{width:100%}p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}a{color:#2156a5;text-decoration:underline;line-height:inherit}a:hover,a:focus{color:#1d4b8f}a img{border:none}p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}p aside{font-size:.875em;line-height:1.35;font-style:italic}h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}h1{font-size:2.125em}h2{font-size:1.6875em}h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}h4,h5{font-size:1.125em}h6{font-size:1em}hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}em,i{font-style:italic;line-height:inherit}strong,b{font-weight:bold;line-height:inherit}small{font-size:60%;line-height:inherit}code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}ul.square{list-style-type:square}ul.circle{list-style-type:circle}ul.disc{list-style-type:disc}ul.no-bullet{list-style:none}ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}dl dt{margin-bottom:.3125em;font-weight:bold}dl dd{margin-bottom:1.25em}abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}abbr{text-transform:none}blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}blockquote cite:before{content:"\2014 \0020"}blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}h1{font-size:2.75em}h2{font-size:2.3125em}h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}h4{font-size:1.4375em}}table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}table thead,table tfoot{background:#f7f8f7;font-weight:bold}table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}body{tab-size:4}h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}.clearfix:after,.float-group:after{clear:both}*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}.keyseq{color:rgba(51,51,51,.8)}kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2) , 0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2) , 0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}.keyseq kbd:first-child{margin-left:0}.keyseq kbd:last-child{margin-right:0}.menuseq,.menu{color:rgba(0,0,0,.8)}b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}b.button:before{content:"[";padding:0 3px 0 2px}b.button:after{content:"]";padding:0 2px 0 3px}p a>code:hover{color:rgba(0,0,0,.9)}#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}#header:after,#content:after,#footnotes:after,#footer:after{clear:both}#content{margin-top:1.25em}#content:before{content:none}#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}#header .details span:first-child{margin-left:-.125em}#header .details span.email a{color:rgba(0,0,0,.85)}#header .details br{display:none}#header .details br+span:before{content:"\00a0\2013\00a0"}#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}#header .details br+span#revremark:before{content:"\00a0|\00a0"}#header #revnumber{text-transform:capitalize}#header #revnumber:after{content:"\00a0"}#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}#toc>ul{margin-left:.125em}#toc ul.sectlevel0>li>a{font-style:italic}#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}#toc li{line-height:1.3334;margin-top:.3334em}#toc a{text-decoration:none}#toc a:active{text-decoration:underline}#toctitle{color:#7a2518;font-size:1.2em}@media only screen and (min-width:768px){#toctitle{font-size:1.375em}body.toc2{padding-left:15em;padding-right:0}#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}#toc.toc2>ul{font-size:.9em;margin-bottom:0}#toc.toc2 ul ul{margin-left:0;padding-left:1em}#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}body.toc2.toc-right{padding-left:0;padding-right:15em}body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}#toc.toc2{width:20em}#toc.toc2 #toctitle{font-size:1.375em}#toc.toc2>ul{font-size:.95em}#toc.toc2 ul ul{padding-left:1.25em}body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}#content #toc>:first-child{margin-top:0}#content #toc>:last-child{margin-bottom:0}#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}#footer-text{color:rgba(255,255,255,.8);line-height:1.44}.sect1{padding-bottom:.625em}@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}.sect1+.sect1{border-top:1px solid #efefed}#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}.admonitionblock>table td.icon{text-align:center;width:80px}.admonitionblock>table td.icon img{max-width:none}.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}.exampleblock>.content>:first-child{margin-top:0}.exampleblock>.content>:last-child{margin-bottom:0}.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}.sidebarblock>:first-child{margin-top:0}.sidebarblock>:last-child{margin-bottom:0}.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}.listingblock pre.highlightjs{padding:0}.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}.listingblock pre.prettyprint{border-width:0}.listingblock>.content{position:relative}.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}.listingblock:hover code[data-lang]:before{display:block}.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}table.pyhltable td.code{padding-left:.75em;padding-right:0}pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}pre.pygments .lineno{display:inline-block;margin-right:.25em}table.pyhltable .linenodiv{background:none!important;padding-right:0!important}.quoteblock{margin:0 1em 1.25em 1.5em;display:table}.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}.quoteblock blockquote{margin:0;padding:0;border:0}.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}.quoteblock .quoteblock blockquote:before{display:none}.verseblock{margin:0 1em 1.25em 1em}.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}.verseblock pre strong{font-weight:400}.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}.quoteblock .attribution br,.verseblock .attribution br{display:none}.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}.quoteblock.abstract{margin:0 0 1.25em 0;display:block}.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}table.tableblock{max-width:100%;border-collapse:separate}table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}table.frame-all{border-width:1px}table.frame-sides{border-width:0 1px}table.frame-topbot{border-width:1px 0}th.halign-left,td.halign-left{text-align:left}th.halign-right,td.halign-right{text-align:right}th.halign-center,td.halign-center{text-align:center}th.valign-top,td.valign-top{vertical-align:top}th.valign-bottom,td.valign-bottom{vertical-align:bottom}th.valign-middle,td.valign-middle{vertical-align:middle}table thead th,table tfoot th{font-weight:bold}tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}p.tableblock>code:only-child{background:none;padding:0}p.tableblock{font-size:1em}td>div.verse{white-space:pre}ol{margin-left:1.75em}ul li ol{margin-left:1.5em}dl dd{margin-left:1.125em}dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}ul.inline>li>*{display:block}.unstyled dl dt{font-weight:400;font-style:normal}ol.arabic{list-style-type:decimal}ol.decimal{list-style-type:decimal-leading-zero}ol.loweralpha{list-style-type:lower-alpha}ol.upperalpha{list-style-type:upper-alpha}ol.lowerroman{list-style-type:lower-roman}ol.upperroman{list-style-type:upper-roman}ol.lowergreek{list-style-type:lower-greek}.hdlist>table,.colist>table{border:0;background:none}.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}td.hdlist1{font-weight:bold;padding-bottom:1.25em}.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}.colist>table tr>td:last-of-type{padding:.25em 0}.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}.imageblock>.title{margin-bottom:0}.imageblock.thumb,.imageblock.th{border-width:6px}.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}.image.left{margin-right:.625em}.image.right{margin-left:.625em}a.image{text-decoration:none;display:inline-block}a.image object{pointer-events:none}sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}sup.footnote a,sup.footnoteref a{text-decoration:none}sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}#footnotes .footnote:last-of-type{margin-bottom:0}#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}.gist .file-data>table td.line-data{width:99%}div.unbreakable{page-break-inside:avoid}.big{font-size:larger}.small{font-size:smaller}.underline{text-decoration:underline}.overline{text-decoration:overline}.line-through{text-decoration:line-through}.aqua{color:#00bfbf}.aqua-background{background-color:#00fafa}.black{color:#000}.black-background{background-color:#000}.blue{color:#0000bf}.blue-background{background-color:#0000fa}.fuchsia{color:#bf00bf}.fuchsia-background{background-color:#fa00fa}.gray{color:#606060}.gray-background{background-color:#7d7d7d}.green{color:#006000}.green-background{background-color:#007d00}.lime{color:#00bf00}.lime-background{background-color:#00fa00}.maroon{color:#600000}.maroon-background{background-color:#7d0000}.navy{color:#000060}.navy-background{background-color:#00007d}.olive{color:#606000}.olive-background{background-color:#7d7d00}.purple{color:#600060}.purple-background{background-color:#7d007d}.red{color:#bf0000}.red-background{background-color:#fa0000}.silver{color:#909090}.silver-background{background-color:#bcbcbc}.teal{color:#006060}.teal-background{background-color:#007d7d}.white{color:#bfbfbf}.white-background{background-color:#fafafa}.yellow{color:#bfbf00}.yellow-background{background-color:#fafa00}span.icon>.fa{cursor:default}.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}.conum[data-value] *{color:#fff!important}.conum[data-value]+b{display:none}.conum[data-value]:after{content:attr(data-value)}pre .conum[data-value]{position:relative;top:-.125em}b.conum *{color:inherit!important}.conum:not([data-value]):empty{display:none}dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}h1,h2,p,td.content,span.alt{letter-spacing:-.01em}p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}p{margin-bottom:1.25rem}.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}.print-only{display:none!important}@media print{@page{margin:1.25cm .75cm}*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}a{color:inherit!important;text-decoration:underline!important}a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}abbr[title]:after{content:" (" attr(title) ")"}pre,blockquote,tr,img,object,svg{page-break-inside:avoid}thead{display:table-header-group}svg{max-width:100%}p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}#toc,.sidebarblock,.exampleblock>.content{background:none!important}#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}.sect1{padding-bottom:0!important}.sect1+.sect1{border:0!important}#header>h1:first-child{margin-top:1.25rem}body.book #header{text-align:center}body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}body.book #header .details{border:0!important;display:block;padding:0!important}body.book #header .details span:first-child{margin-left:0!important}body.book #header .details br{display:block}body.book #header .details br+span:before{content:none!important}body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}.listingblock code[data-lang]:before{display:block}#footer{background:none!important;padding:0 .9375em}#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}.hide-on-print{display:none!important}.print-only{display:block!important}.hide-for-print{display:none!important}.show-for-print{display:inherit!important}}</style>
<link rel="stylesheet" href="../../../../../../cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Spring Session</h1>
<div class="details">
<span id="author" class="author">Rob Winch, Vedran PaviÄ‡</span><br>
<span id="revnumber">version 2.0.2.RELEASE</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="index.html#introduction">1. Introduction</a></li>
<li><a href="index.html#what-s-new-in-2-0">2. What&#8217;s New in 2.0</a></li>
<li><a href="index.html#samples">3. Samples and Guides (Start Here)</a></li>
<li><a href="index.html#modules">4. Spring Session Modules</a></li>
<li><a href="index.html#httpsession">5. HttpSession Integration</a>
<ul class="sectlevel2">
<li><a href="index.html#httpsession-why">5.1. Why Spring Session &amp; HttpSession?</a></li>
<li><a href="index.html#httpsession-redis">5.2. HttpSession with Redis</a></li>
<li><a href="index.html#httpsession-jdbc">5.3. HttpSession with JDBC</a></li>
<li><a href="index.html#httpsession-hazelcast">5.4. HttpSession with Hazelcast</a></li>
<li><a href="index.html#httpsession-how">5.5. How HttpSession Integration Works</a></li>
<li><a href="index.html#httpsession-rest">5.6. HttpSession &amp; RESTful APIs</a></li>
<li><a href="index.html#httpsession-httpsessionlistener">5.7. HttpSessionListener</a></li>
</ul>
</li>
<li><a href="index.html#websocket">6. WebSocket Integration</a>
<ul class="sectlevel2">
<li><a href="index.html#websocket-why">6.1. Why Spring Session &amp; WebSockets?</a></li>
<li><a href="index.html#websocket-usage">6.2. WebSocket Usage</a></li>
</ul>
</li>
<li><a href="index.html#websession">7. WebSession Integration</a>
<ul class="sectlevel2">
<li><a href="index.html#websession-why">7.1. Why Spring Session &amp; WebSession?</a></li>
<li><a href="index.html#websession-redis">7.2. WebSession with Redis</a></li>
<li><a href="index.html#websession-how">7.3. How WebSession Integration Works</a></li>
</ul>
</li>
<li><a href="index.html#spring-security">8. Spring Security Integration</a>
<ul class="sectlevel2">
<li><a href="index.html#spring-security-rememberme">8.1. Spring Security Remember-Me Support</a></li>
<li><a href="index.html#spring-security-concurrent-sessions">8.2. Spring Security Concurrent Session Control</a></li>
<li><a href="index.html#spring-security-concurrent-sessions-limitations">8.3. Limitations</a></li>
</ul>
</li>
<li><a href="index.html#api">9. API Documentation</a>
<ul class="sectlevel2">
<li><a href="index.html#api-session">9.1. Session</a></li>
<li><a href="index.html#api-sessionrepository">9.2. SessionRepository</a></li>
<li><a href="index.html#api-findbyindexnamesessionrepository">9.3. FindByIndexNameSessionRepository</a></li>
<li><a href="index.html#api-reactivesessionrepository">9.4. ReactiveSessionRepository</a></li>
<li><a href="index.html#api-enablespringhttpsession">9.5. EnableSpringHttpSession</a></li>
<li><a href="index.html#api-enablespringwebsession">9.6. EnableSpringWebSession</a></li>
<li><a href="index.html#api-redisoperationssessionrepository">9.7. RedisOperationsSessionRepository</a></li>
<li><a href="index.html#api-reactiveredisoperationssessionrepository">9.8. ReactiveRedisOperationsSessionRepository</a></li>
<li><a href="index.html#api-mapsessionrepository">9.9. MapSessionRepository</a></li>
<li><a href="index.html#api-reactivemapsessionrepository">9.10. ReactiveMapSessionRepository</a></li>
<li><a href="index.html#api-jdbcoperationssessionrepository">9.11. JdbcOperationsSessionRepository</a></li>
<li><a href="index.html#api-hazelcastsessionrepository">9.12. HazelcastSessionRepository</a></li>
</ul>
</li>
<li><a href="index.html#custom-sessionrepository">10. Custom SessionRepository</a></li>
<li><a href="index.html#upgrading-2.0">11. Upgrading to 2.x</a>
<ul class="sectlevel2">
<li><a href="index.html#baseline-update">11.1. Baseline update</a></li>
<li><a href="index.html#replaced-and-removed-modules">11.2. Replaced and Removed Modules</a></li>
<li><a href="index.html#replaced-and-removed-packages-classes-and-methods">11.3. Replaced and Removed Packages, Classes and Methods</a></li>
<li><a href="index.html#dropped-support">11.4. Dropped Support</a></li>
</ul>
</li>
<li><a href="index.html#community">12. Spring Session Community</a>
<ul class="sectlevel2">
<li><a href="index.html#community-support">12.1. Support</a></li>
<li><a href="index.html#community-source">12.2. Source Code</a></li>
<li><a href="index.html#community-issues">12.3. Issue Tracking</a></li>
<li><a href="index.html#community-contributing">12.4. Contributing</a></li>
<li><a href="index.html#community-license">12.5. License</a></li>
<li><a href="index.html#community-extensions">12.6. Community Extensions</a></li>
</ul>
</li>
<li><a href="index.html#minimum-requirements">13. Minimum Requirements</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div id="abstract" class="paragraph">
<p>Spring Session provides an API and implementations for managing a user&#8217;s session information.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="index.html#introduction"></a>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Session provides an API and implementations for managing a user&#8217;s session information, while also making it trivial to support clustered sessions without being tied to an application container specific solution.
It also provides transparent integration with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="index.html#httpsession">HttpSession</a> - allows replacing the <code>HttpSession</code> in an application container (i.e. Tomcat) neutral way, with support for providing session IDs in headers to work with RESTful APIs.</p>
</li>
<li>
<p><a href="index.html#websocket">WebSocket</a> - provides the ability to keep the <code>HttpSession</code> alive when receiving WebSocket messages</p>
</li>
<li>
<p><a href="index.html#websession">WebSession</a> - allows replacing the Spring WebFlux&#8217;s <code>WebSession</code> in an application container neutral way.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-s-new-in-2-0"><a class="anchor" href="index.html#what-s-new-in-2-0"></a>2. What&#8217;s New in 2.0</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Below are the highlights of what is new in Spring Session 2.0. You can find a complete list of what&#8217;s new by referring to the changelogs of
<a href="https://github.com/spring-projects/spring-session/milestone/17?closed=1">2.0.0.M1</a>,
<a href="https://github.com/spring-projects/spring-session/milestone/22?closed=1">2.0.0.M2</a>,
<a href="https://github.com/spring-projects/spring-session/milestone/23?closed=1">2.0.0.M3</a>,
<a href="https://github.com/spring-projects/spring-session/milestone/24?closed=1">2.0.0.M4</a>,
<a href="https://github.com/spring-projects/spring-session/milestone/25?closed=1">2.0.0.M5</a>,
<a href="https://github.com/spring-projects/spring-session/milestone/26?closed=1">2.0.0.RC1</a>,
<a href="https://github.com/spring-projects/spring-session/milestone/27?closed=1">2.0.0.RC2</a>, and
<a href="https://github.com/spring-projects/spring-session/milestone/30?closed=1">2.0.0.RELEASE</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Upgraded to Java 8 and Spring Framework 5 as baseline</p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-session/issues/683">Added support for managing Spring WebFlux&#8217;s <code>WebSession</code></a> with <a href="https://github.com/spring-projects/spring-session/issues/816">Redis <code>ReactiveSessionRepository</code></a></p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-session/issues/768">Extracted <code>SessionRepository</code> implementations to separate modules</a></p>
</li>
<li>
<p>Improved <a href="https://github.com/spring-projects/spring-session/issues/682"><code>Session</code></a> and <a href="https://github.com/spring-projects/spring-session/issues/809"><code>SessionRepository</code></a> APIs</p>
</li>
<li>
<p>Improved and harmonized configuration support for all supported session stores</p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-session/pull/713">Added support for configuring default <code>CookieSerializer</code> using <code>SessionCookieConfig</code></a></p>
</li>
<li>
<p>Lots of performance improvements and bug fixes</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="samples"><a class="anchor" href="index.html#samples"></a>3. Samples and Guides (Start Here)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you are looking to get started with Spring Session, the best place to start is our Sample Applications.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Sample Applications using Spring Boot</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Source</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Guide</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/2.0.2.RELEASE/samples/boot/redis">HttpSession with Redis</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with Redis.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/current/reference/html5/guides/boot-redis.html">HttpSession with Redis Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/2.0.2.RELEASE/samples/boot/jdbc">HttpSession with JDBC</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with a relational database store.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/current/reference/html5/guides/boot-jdbc.html">HttpSession with JDBC Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/2.0.2.RELEASE/samples/boot/findbyusername">Find by Username</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to find sessions by username.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/current/reference/html5/guides/boot-findbyusername.html">Find by Username Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/2.0.2.RELEASE/samples/boot/websocket">WebSockets</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session with WebSockets.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/current/reference/html5/guides/boot-websocket.html">WebSockets Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/2.0.2.RELEASE/samples/boot/webflux">WebFlux</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the Spring WebFlux&#8217;s <code>WebSession</code> with Redis.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/2.0.2.RELEASE/samples/boot/redis-json">HttpSession with Redis JSON serialization</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with Redis using JSON serialization.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBD</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. Sample Applications using Spring Java based configuration</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Source</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Guide</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/2.0.2.RELEASE/samples/javaconfig/redis">HttpSession with Redis</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with Redis.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/current/reference/html5/guides/java-redis.html">HttpSession with Redis Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/2.0.2.RELEASE/samples/javaconfig/jdbc">HttpSession with JDBC</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with a relational database store.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/current/reference/html5/guides/java-jdbc.html">HttpSession with JDBC Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/2.0.2.RELEASE/samples/javaconfig/hazelcast">HttpSession with Hazelcast</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with Hazelcast.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/current/reference/html5/guides/java-hazelcast.html">HttpSession with Hazelcast Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/2.0.2.RELEASE/samples/javaconfig/custom-cookie">Custom Cookie</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session and customize the cookie.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/current/reference/html5/guides/java-custom-cookie.html">Custom Cookie Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/2.0.2.RELEASE/samples/javaconfig/security">Spring Security</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session with an existing Spring Security application.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/current/reference/html5/guides/java-security.html">Spring Security Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/2.0.2.RELEASE/samples/javaconfig/rest">REST</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session in a REST application to support authenticating with a header.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/current/reference/html5/guides/java-rest.html">REST Guide</a></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 3. Sample Applications using Spring XML based configuration</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Source</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Guide</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/2.0.2.RELEASE/samples/xml/redis">HttpSession with Redis</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with a Redis store.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/current/reference/html5/guides/xml-redis.html">HttpSession with Redis Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/2.0.2.RELEASE/samples/xml/jdbc">HttpSession with JDBC</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with a relational database store.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/current/reference/html5/guides/xml-jdbc.html">HttpSession with JDBC Guide</a></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 4. Misc sample Applications</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Source</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Guide</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/2.0.2.RELEASE/samples/misc/grails3">Grails 3</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session with Grails 3.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/current/reference/html5/guides/grails3.html">Grails 3 Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/2.0.2.RELEASE/samples/misc/hazelcast">Hazelcast</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session with Hazelcast in a Java EE application.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBD</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="modules"><a class="anchor" href="index.html#modules"></a>4. Spring Session Modules</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Spring Session 1.x all of the Spring Session&#8217;s <code>SessionRepository</code> implementations were available within the <code>spring-session</code> artifact.
While convenient, this approach wasn&#8217;t sustainable long-term as more features and <code>SessionRepository</code> implementations were added to the project.</p>
</div>
<div class="paragraph">
<p>Starting with Spring Session 2.0, the project has been split up to Spring Session Core module, and several other modules that carry <code>SessionRepository</code> implementations and functionality related to the specific data store.
The users of Spring Data will find this arrangement familiar, with Spring Session Core module taking a role equivalent to Spring Data Commons and providing core functionalities and APIs with other modules containing data store specific implementations.
As a part of this split, the Spring Session Data MongoDB and Spring Session Data GemFire modules were moved to separate repositories so the situation with project&#8217;s repositories/modules is a follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/spring-projects/spring-session"><code>spring-session</code> repository</a></p>
<div class="ulist">
<ul>
<li>
<p>Hosts Spring Session Core, Spring Session Data Redis, Spring Session JDBC and Spring Session Hazelcast modules</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-session-data-mongodb"><code>spring-session-data-mongodb</code> repository</a></p>
<div class="ulist">
<ul>
<li>
<p>Hosts Spring Session Data MongoDB module</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-session-data-geode"><code>spring-session-data-geode</code> repository</a></p>
<div class="ulist">
<ul>
<li>
<p>Hosts Spring Session Data Geode/GemFire module</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Going forward, the plan is to externalize each of the <code>SessionRepository</code> implementations into a dedicated repository and provide a Maven BOM (as in "bill of materials") module in order to help users with version management concerns.</p>
</div>
<div class="paragraph">
<p>Modules maintained by the members of Spring Team will be hosted within the <a href="https://github.com/spring-projects"><code>spring-projects</code> organization</a>, while the community maintained modules will continue to be promoted via <a href="index.html#community-extensions">Community Extensions</a> section of this manual.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="httpsession"><a class="anchor" href="index.html#httpsession"></a>5. HttpSession Integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Session provides transparent integration with <code>HttpSession</code>.
This means that developers can switch the <code>HttpSession</code> implementation out with an implementation that is backed by Spring Session.</p>
</div>
<div class="sect2">
<h3 id="httpsession-why"><a class="anchor" href="index.html#httpsession-why"></a>5.1. Why Spring Session &amp; HttpSession?</h3>
<div class="paragraph">
<p>We have already mentioned that Spring Session provides transparent integration with <code>HttpSession</code>, but what benefits do we get out of this?</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Clustered Sessions</strong> - Spring Session makes it trivial to support <a href="index.html#httpsession-redis">clustered sessions</a> without being tied to an application container specific solution.</p>
</li>
<li>
<p><strong>RESTful APIs</strong> - Spring Session allows providing session IDs in headers to work with <a href="index.html#httpsession-rest">RESTful APIs</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-redis"><a class="anchor" href="index.html#httpsession-redis"></a>5.2. HttpSession with Redis</h3>
<div class="paragraph">
<p>Using Spring Session with <code>HttpSession</code> is enabled by adding a Servlet Filter before anything that uses the <code>HttpSession</code>.
You can choose from enabling this using either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="index.html#httpsession-redis-jc">Java Based Configuration</a></p>
</li>
<li>
<p><a href="index.html#httpsession-redis-xml">XML Based Configuration</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="httpsession-redis-jc"><a class="anchor" href="index.html#httpsession-redis-jc"></a>5.2.1. Redis Java Based Configuration</h4>
<div class="paragraph">
<p>This section describes how to use Redis to back <code>HttpSession</code> using Java based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="index.html#samples">HttpSession Sample</a> provides a working sample on how to integrate Spring Session and <code>HttpSession</code> using Java configuration.
You can read the basic steps for integration below, but you are encouraged to follow along with the detailed HttpSession Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="httpsession-spring-configuration"><a class="anchor" href="index.html#httpsession-spring-configuration"></a>Spring Java Configuration</h5>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a Servlet Filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
Add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@EnableRedisHttpSession <i class="conum" data-value="1"></i><b>(1)</b>
public class Config {

	@Bean
	public LettuceConnectionFactory connectionFactory() {
		return new LettuceConnectionFactory(); <i class="conum" data-value="2"></i><b>(2)</b>
	}
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@EnableRedisHttpSession</code> annotation creates a Spring Bean with the name of <code>springSessionRepositoryFilter</code> that implements Filter.
The filter is what is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance Spring Session is backed by Redis.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a <code>RedisConnectionFactory</code> that connects Spring Session to the Redis Server.
We configure the connection to connect to localhost on the default port (6379)
For more information on configuring Spring Data Redis, refer to the <a href="https://docs.spring.io/spring-data/data-redis/docs/2.0.4.RELEASE/reference/html/">reference documentation</a>.</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="java-servlet-container-initialization"><a class="anchor" href="index.html#java-servlet-container-initialization"></a>Java Servlet Container Initialization</h5>
<div class="paragraph">
<p>Our <a href="index.html#httpsession-spring-configuration">Spring Configuration</a> created a Spring Bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, Spring needs to load our <code>Config</code> class.
Last we need to ensure that our Servlet Container (i.e. Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
Fortunately, Spring Session provides a utility class named <code>AbstractHttpSessionApplicationInitializer</code> both of these steps extremely easy.
You can find an example below:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/sample/Initializer.java</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public class Initializer extends AbstractHttpSessionApplicationInitializer { <i class="conum" data-value="1"></i><b>(1)</b>

	public Initializer() {
		super(Config.class); <i class="conum" data-value="2"></i><b>(2)</b>
	}
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The name of our class (Initializer) does not matter. What is important is that we extend <code>AbstractHttpSessionApplicationInitializer</code>.
</td>
</tr>
</table>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The first step is to extend <code>AbstractHttpSessionApplicationInitializer</code>.
This ensures that the Spring Bean by the name <code>springSessionRepositoryFilter</code> is registered with our Servlet Container for every request.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>AbstractHttpSessionApplicationInitializer</code> also provides a mechanism to easily ensure Spring loads our <code>Config</code>.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="httpsession-redis-xml"><a class="anchor" href="index.html#httpsession-redis-xml"></a>5.2.2. Redis XML Based Configuration</h4>
<div class="paragraph">
<p>This section describes how to use Redis to back <code>HttpSession</code> using XML based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="index.html#samples">HttpSession XML Sample</a> provides a working sample on how to integrate Spring Session and <code>HttpSession</code> using XML configuration.
You can read the basic steps for integration below, but you are encouraged to follow along with the detailed HttpSession XML Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="httpsession-xml-spring-configuration"><a class="anchor" href="index.html#httpsession-xml-spring-configuration"></a>Spring XML Configuration</h5>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a Servlet Filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
Add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/spring/session.xml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml"><i class="conum" data-value="1"></i><b>(1)</b>
&lt;context:annotation-config/&gt;
&lt;bean class="org.springframework.session.data.redis.config.annotation.web.http.RedisHttpSessionConfiguration"/&gt;

<i class="conum" data-value="2"></i><b>(2)</b>
&lt;bean class="org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory"/&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We use the combination of <code>&lt;context:annotation-config/&gt;</code> and <code>RedisHttpSessionConfiguration</code> because Spring Session does not yet provide XML Namespace support (see <a href="https://github.com/spring-projects/spring-session/issues/104">gh-104</a>).
This creates a Spring Bean with the name of <code>springSessionRepositoryFilter</code> that implements Filter.
The filter is what is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance Spring Session is backed by Redis.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a <code>RedisConnectionFactory</code> that connects Spring Session to the Redis Server.
We configure the connection to connect to localhost on the default port (6379)
For more information on configuring Spring Data Redis, refer to the <a href="https://docs.spring.io/spring-data/data-redis/docs/2.0.4.RELEASE/reference/html/">reference documentation</a>.</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="xml-servlet-container-initialization"><a class="anchor" href="index.html#xml-servlet-container-initialization"></a>XML Servlet Container Initialization</h5>
<div class="paragraph">
<p>Our <a href="index.html#httpsession-xml-spring-configuration">Spring Configuration</a> created a Spring Bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, we need to instruct Spring to load our <code>session.xml</code> configuration.
We do this with the following configuration:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/web.xml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;context-param&gt;
	&lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
	&lt;param-value&gt;
		/WEB-INF/spring/*.xml
	&lt;/param-value&gt;
&lt;/context-param&gt;
&lt;listener&gt;
	&lt;listener-class&gt;
		org.springframework.web.context.ContextLoaderListener
	&lt;/listener-class&gt;
&lt;/listener&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://docs.spring.io/spring/docs/5.0.4.RELEASE/spring-framework-reference/core.html#context-create">ContextLoaderListener</a> reads the contextConfigLocation and picks up our session.xml configuration.</p>
</div>
<div class="paragraph">
<p>Last we need to ensure that our Servlet Container (i.e. Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
The following snippet performs this last step for us:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/web.xml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;filter&gt;
	&lt;filter-name&gt;springSessionRepositoryFilter&lt;/filter-name&gt;
	&lt;filter-class&gt;org.springframework.web.filter.DelegatingFilterProxy&lt;/filter-class&gt;
&lt;/filter&gt;
&lt;filter-mapping&gt;
	&lt;filter-name&gt;springSessionRepositoryFilter&lt;/filter-name&gt;
	&lt;url-pattern&gt;/*&lt;/url-pattern&gt;
	&lt;dispatcher&gt;REQUEST&lt;/dispatcher&gt;
	&lt;dispatcher&gt;ERROR&lt;/dispatcher&gt;
&lt;/filter-mapping&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://docs.spring.io/spring-framework/docs/5.0.4.RELEASE/javadoc-api/org/springframework/web/filter/DelegatingFilterProxy.html">DelegatingFilterProxy</a> will look up a Bean by the name of <code>springSessionRepositoryFilter</code> and cast it to a <code>Filter</code>.
For every request that <code>DelegatingFilterProxy</code> is invoked, the <code>springSessionRepositoryFilter</code> will be invoked.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-jdbc"><a class="anchor" href="index.html#httpsession-jdbc"></a>5.3. HttpSession with JDBC</h3>
<div class="paragraph">
<p>Using Spring Session with <code>HttpSession</code> is enabled by adding a Servlet Filter before anything that uses the <code>HttpSession</code>.
You can choose from enabling this using either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="index.html#httpsession-jdbc-jc">Java Based Configuration</a></p>
</li>
<li>
<p><a href="index.html#httpsession-jdbc-xml">XML Based Configuration</a></p>
</li>
<li>
<p><a href="index.html#httpsession-jdbc-boot">Spring Boot Based Configuration</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="httpsession-jdbc-jc"><a class="anchor" href="index.html#httpsession-jdbc-jc"></a>5.3.1. JDBC Java Based Configuration</h4>
<div class="paragraph">
<p>This section describes how to use a relational database to back <code>HttpSession</code> using Java based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="index.html#samples">HttpSession JDBC Sample</a> provides a working sample on how to integrate Spring Session and <code>HttpSession</code> using Java configuration.
You can read the basic steps for integration below, but you are encouraged to follow along with the detailed HttpSession JDBC Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="httpsession-jdbc-spring-configuration"><a class="anchor" href="index.html#httpsession-jdbc-spring-configuration"></a>Spring Java Configuration</h5>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a Servlet Filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
Add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@EnableJdbcHttpSession <i class="conum" data-value="1"></i><b>(1)</b>
public class Config {

	@Bean
	public EmbeddedDatabase dataSource() {
		return new EmbeddedDatabaseBuilder() <i class="conum" data-value="2"></i><b>(2)</b>
				.setType(EmbeddedDatabaseType.H2)
				.addScript("org/springframework/session/jdbc/schema-h2.sql").build();
	}

	@Bean
	public PlatformTransactionManager transactionManager(DataSource dataSource) {
		return new DataSourceTransactionManager(dataSource); <i class="conum" data-value="3"></i><b>(3)</b>
	}

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@EnableJdbcHttpSession</code> annotation creates a Spring Bean with the name of <code>springSessionRepositoryFilter</code> that implements Filter.
The filter is what is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance Spring Session is backed by a relational database.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a <code>dataSource</code> that connects Spring Session to an embedded instance of H2 database.
We configure the H2 database to create database tables using the SQL script which is included in Spring Session.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We create a <code>transactionManager</code> that manages transactions for previously configured <code>dataSource</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For additional information on how to configure data access related concerns, please refer to the <a href="https://docs.spring.io/spring/docs/5.0.4.RELEASE/spring-framework-reference/data-access.html">Spring Framework Reference Documentation</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="java-servlet-container-initialization-2"><a class="anchor" href="index.html#java-servlet-container-initialization-2"></a>Java Servlet Container Initialization</h5>
<div class="paragraph">
<p>Our <a href="index.html#httpsession-spring-configuration">Spring Configuration</a> created a Spring Bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, Spring needs to load our <code>Config</code> class.
Last we need to ensure that our Servlet Container (i.e. Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
Fortunately, Spring Session provides a utility class named <code>AbstractHttpSessionApplicationInitializer</code> both of these steps extremely easy.
You can find an example below:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/sample/Initializer.java</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public class Initializer extends AbstractHttpSessionApplicationInitializer { <i class="conum" data-value="1"></i><b>(1)</b>

	public Initializer() {
		super(Config.class); <i class="conum" data-value="2"></i><b>(2)</b>
	}
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The name of our class (Initializer) does not matter. What is important is that we extend <code>AbstractHttpSessionApplicationInitializer</code>.
</td>
</tr>
</table>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The first step is to extend <code>AbstractHttpSessionApplicationInitializer</code>.
This ensures that the Spring Bean by the name <code>springSessionRepositoryFilter</code> is registered with our Servlet Container for every request.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>AbstractHttpSessionApplicationInitializer</code> also provides a mechanism to easily ensure Spring loads our <code>Config</code>.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="httpsession-jdbc-xml"><a class="anchor" href="index.html#httpsession-jdbc-xml"></a>5.3.2. JDBC XML Based Configuration</h4>
<div class="paragraph">
<p>This section describes how to use a relational database to back <code>HttpSession</code> using XML based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="index.html#samples">HttpSession JDBC XML Sample</a> provides a working sample on how to integrate Spring Session and <code>HttpSession</code> using XML configuration.
You can read the basic steps for integration below, but you are encouraged to follow along with the detailed HttpSession JDBC XML Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="httpsession-jdbc-xml-spring-configuration"><a class="anchor" href="index.html#httpsession-jdbc-xml-spring-configuration"></a>Spring XML Configuration</h5>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a Servlet Filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
Add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/spring/session.xml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml"><i class="conum" data-value="1"></i><b>(1)</b>
&lt;context:annotation-config/&gt;
&lt;bean class="org.springframework.session.jdbc.config.annotation.web.http.JdbcHttpSessionConfiguration"/&gt;

<i class="conum" data-value="2"></i><b>(2)</b>
&lt;jdbc:embedded-database id="dataSource" database-name="testdb" type="H2"&gt;
	&lt;jdbc:script location="classpath:org/springframework/session/jdbc/schema-h2.sql"/&gt;
&lt;/jdbc:embedded-database&gt;

<i class="conum" data-value="3"></i><b>(3)</b>
&lt;bean class="org.springframework.jdbc.datasource.DataSourceTransactionManager"&gt;
	&lt;constructor-arg ref="dataSource"/&gt;
&lt;/bean&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We use the combination of <code>&lt;context:annotation-config/&gt;</code> and <code>JdbcHttpSessionConfiguration</code> because Spring Session does not yet provide XML Namespace support (see <a href="https://github.com/spring-projects/spring-session/issues/104">gh-104</a>).
This creates a Spring Bean with the name of <code>springSessionRepositoryFilter</code> that implements Filter.
The filter is what is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance Spring Session is backed by a relational database.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a <code>dataSource</code> that connects Spring Session to an embedded instance of H2 database.
We configure the H2 database to create database tables using the SQL script which is included in Spring Session.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We create a <code>transactionManager</code> that manages transactions for previously configured <code>dataSource</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For additional information on how to configure data access related concerns, please refer to the <a href="https://docs.spring.io/spring/docs/5.0.4.RELEASE/spring-framework-reference/data-access.html">Spring Framework Reference Documentation</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="xml-servlet-container-initialization-2"><a class="anchor" href="index.html#xml-servlet-container-initialization-2"></a>XML Servlet Container Initialization</h5>
<div class="paragraph">
<p>Our <a href="index.html#httpsession-xml-spring-configuration">Spring Configuration</a> created a Spring Bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, we need to instruct Spring to load our <code>session.xml</code> configuration.
We do this with the following configuration:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/web.xml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;context-param&gt;
	&lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
	&lt;param-value&gt;
		/WEB-INF/spring/*.xml
	&lt;/param-value&gt;
&lt;/context-param&gt;
&lt;listener&gt;
	&lt;listener-class&gt;
		org.springframework.web.context.ContextLoaderListener
	&lt;/listener-class&gt;
&lt;/listener&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://docs.spring.io/spring/docs/5.0.4.RELEASE/spring-framework-reference/core.html#context-create">ContextLoaderListener</a> reads the contextConfigLocation and picks up our session.xml configuration.</p>
</div>
<div class="paragraph">
<p>Last we need to ensure that our Servlet Container (i.e. Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
The following snippet performs this last step for us:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/web.xml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;filter&gt;
	&lt;filter-name&gt;springSessionRepositoryFilter&lt;/filter-name&gt;
	&lt;filter-class&gt;org.springframework.web.filter.DelegatingFilterProxy&lt;/filter-class&gt;
&lt;/filter&gt;
&lt;filter-mapping&gt;
	&lt;filter-name&gt;springSessionRepositoryFilter&lt;/filter-name&gt;
	&lt;url-pattern&gt;/*&lt;/url-pattern&gt;
	&lt;dispatcher&gt;REQUEST&lt;/dispatcher&gt;
	&lt;dispatcher&gt;ERROR&lt;/dispatcher&gt;
&lt;/filter-mapping&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://docs.spring.io/spring-framework/docs/5.0.4.RELEASE/javadoc-api/org/springframework/web/filter/DelegatingFilterProxy.html">DelegatingFilterProxy</a> will look up a Bean by the name of <code>springSessionRepositoryFilter</code> and cast it to a <code>Filter</code>.
For every request that <code>DelegatingFilterProxy</code> is invoked, the <code>springSessionRepositoryFilter</code> will be invoked.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="httpsession-jdbc-boot"><a class="anchor" href="index.html#httpsession-jdbc-boot"></a>5.3.3. JDBC Spring Boot Based Configuration</h4>
<div class="paragraph">
<p>This section describes how to use a relational database to back <code>HttpSession</code> when using Spring Boot.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="index.html#samples">HttpSession JDBC Spring Boot Sample</a> provides a working sample on how to integrate Spring Session and <code>HttpSession</code> using Spring Boot.
You can read the basic steps for integration below, but you are encouraged to follow along with the detailed HttpSession JDBC Spring Boot Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="httpsession-jdbc-boot-spring-configuration"><a class="anchor" href="index.html#httpsession-jdbc-boot-spring-configuration"></a>Spring Boot Configuration</h5>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring Boot configuration.
Thanks to first-class auto configuration support, setting up Spring Session backed by a relational database is as simple as adding a single configuration property to your <code>application.properties</code>:</p>
</div>
<div class="listingblock">
<div class="title">src/main/resources/application.properties</div>
<div class="content">
<pre>spring.session.store-type=jdbc</pre>
</div>
</div>
<div class="paragraph">
<p>Under the hood, Spring Boot will apply configuration that is equivalent to manually adding <code>@EnableJdbcHttpSession</code> annotation.
This creates a Spring Bean with the name of <code>springSessionRepositoryFilter</code> that implements Filter.
The filter is what is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>Further customization is possible using <code>application.properties</code>:</p>
</div>
<div class="listingblock">
<div class="title">src/main/resources/application.properties</div>
<div class="content">
<pre>server.session.timeout= # Session timeout in seconds.
spring.session.jdbc.initializer.enabled= # Create the required session tables on startup if necessary. Enabled automatically if the default table name is set or a custom schema is configured.
spring.session.jdbc.schema=classpath:org/springframework/session/jdbc/<a href="https://docs.spring.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e0938388858d81cda0">[email&#160;protected]</a>@<a href="https://docs.spring.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d8a8b4b9acbeb7aab598">[email&#160;protected]</a>@.sql # Path to the SQL file to use to initialize the database schema.
spring.session.jdbc.table-name=SPRING_SESSION # Name of database table used to store sessions.</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, refer to <a href="https://docs.spring.io/spring-boot/docs/{spring-boot-version}/reference/htmlsingle/#boot-features-session">Spring Session</a> portion of the Spring Boot documentation.</p>
</div>
</div>
<div class="sect4">
<h5 id="httpsession-jdbc-boot-configuration"><a class="anchor" href="index.html#httpsession-jdbc-boot-configuration"></a>Configuring the DataSource</h5>
<div class="paragraph">
<p>Spring Boot automatically creates a <code>DataSource</code> that connects Spring Session to an embedded instance of H2 database.
In a production environment you need to ensure to update your configuration to point to your relational database.
For example, you can include the following in your <strong>application.properties</strong></p>
</div>
<div class="listingblock">
<div class="title">src/main/resources/application.properties</div>
<div class="content">
<pre>spring.datasource.url=jdbc:postgresql://localhost:5432/myapp
spring.datasource.username=myapp
spring.datasource.password=secret</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, refer to <a href="https://docs.spring.io/spring-boot/docs/{spring-boot-version}/reference/htmlsingle/#boot-features-configure-datasource">Configure a DataSource</a> portion of the Spring Boot documentation.</p>
</div>
</div>
<div class="sect4">
<h5 id="httpsession-jdbc-boot-servlet-configuration"><a class="anchor" href="index.html#httpsession-jdbc-boot-servlet-configuration"></a>Servlet Container Initialization</h5>
<div class="paragraph">
<p>Our <a href="index.html#httpsession-jdbc-boot-spring-configuration">Spring Boot Configuration</a> created a Spring Bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, Spring needs to load our <code>Config</code> class.
Last we need to ensure that our Servlet Container (i.e. Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
Fortunately, Spring Boot takes care of both of these steps for us.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-hazelcast"><a class="anchor" href="index.html#httpsession-hazelcast"></a>5.4. HttpSession with Hazelcast</h3>
<div class="paragraph">
<p>Using Spring Session with <code>HttpSession</code> is enabled by adding a Servlet Filter before anything that uses the <code>HttpSession</code>.</p>
</div>
<div class="paragraph">
<p>This section describes how to use Hazelcast to back <code>HttpSession</code> using Java based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="index.html#samples">Hazelcast Spring Sample</a> provides a working sample on how to integrate Spring Session and <code>HttpSession</code> using Java configuration.
You can read the basic steps for integration below, but you are encouraged to follow along with the detailed Hazelcast Spring Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="security-spring-configuration"><a class="anchor" href="index.html#security-spring-configuration"></a>5.4.1. Spring Configuration</h4>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a Servlet Filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
Add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@EnableHazelcastHttpSession <i class="conum" data-value="1"></i><b>(1)</b>
@Configuration
public class HazelcastHttpSessionConfig {

	@Bean
	public HazelcastInstance hazelcastInstance() {
		MapAttributeConfig attributeConfig = new MapAttributeConfig()
				.setName(HazelcastSessionRepository.PRINCIPAL_NAME_ATTRIBUTE)
				.setExtractor(PrincipalNameExtractor.class.getName());

		Config config = new Config();

		config.getMapConfig(HazelcastSessionRepository.DEFAULT_SESSION_MAP_NAME) <i class="conum" data-value="2"></i><b>(2)</b>
				.addMapAttributeConfig(attributeConfig)
				.addMapIndexConfig(new MapIndexConfig(
						HazelcastSessionRepository.PRINCIPAL_NAME_ATTRIBUTE, false));

		return Hazelcast.newHazelcastInstance(config); <i class="conum" data-value="3"></i><b>(3)</b>
	}

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@EnableHazelcastHttpSession</code> annotation creates a Spring Bean with the name of <code>springSessionRepositoryFilter</code> that implements Filter.
The filter is what is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance Spring Session is backed by Hazelcast.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>In order to support retrieval of sessions by principal name index, appropriate <code>ValueExtractor</code> needs to be registered.
Spring Session provides <code>PrincipalNameExtractor</code> for this purpose.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We create a <code>HazelcastInstance</code> that connects Spring Session to Hazelcast.
By default, an embedded instance of Hazelcast is started and connected to by the application.
For more information on configuring Hazelcast, refer to the <a href="http://docs.hazelcast.org/docs/3.9.3/manual/html-single/index.html#hazelcast-configuration">reference documentation</a>.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="servlet-container-initialization"><a class="anchor" href="index.html#servlet-container-initialization"></a>5.4.2. Servlet Container Initialization</h4>
<div class="paragraph">
<p>Our <a href="index.html#security-spring-configuration">Spring Configuration</a> created a Spring Bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, Spring needs to load our <code>SessionConfig</code> class.
Since our application is already loading Spring configuration using our <code>SecurityInitializer</code> class, we can simply add our <code>SessionConfig</code> class to it.</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/sample/SecurityInitializer.java</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public class SecurityInitializer extends AbstractSecurityWebApplicationInitializer {

	public SecurityInitializer() {
		super(SecurityConfig.class, SessionConfig.class);
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Last we need to ensure that our Servlet Container (i.e. Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
It is extremely important that Spring Session&#8217;s <code>springSessionRepositoryFilter</code> is invoked before Spring Security&#8217;s <code>springSecurityFilterChain</code>.
This ensures that the <code>HttpSession</code> that Spring Security uses is backed by Spring Session.
Fortunately, Spring Session provides a utility class named <code>AbstractHttpSessionApplicationInitializer</code> that makes this extremely easy.
You can find an example below:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/sample/Initializer.java</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public class Initializer extends AbstractHttpSessionApplicationInitializer {

}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The name of our class (Initializer) does not matter. What is important is that we extend <code>AbstractHttpSessionApplicationInitializer</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By extending <code>AbstractHttpSessionApplicationInitializer</code> we ensure that the Spring Bean by the name <code>springSessionRepositoryFilter</code> is registered with our Servlet Container for every request before Spring Security&#8217;s <code>springSecurityFilterChain</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-how"><a class="anchor" href="index.html#httpsession-how"></a>5.5. How HttpSession Integration Works</h3>
<div class="paragraph">
<p>Fortunately both <code>HttpSession</code> and <code>HttpServletRequest</code> (the API for obtaining an <code>HttpSession</code>) are both interfaces.
This means that we can provide our own implementations for each of these APIs.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This section describes how Spring Session provides transparent integration with <code>HttpSession</code>. The intent is so that user&#8217;s can understand what is happening under the covers. This functionality is already integrated and you do NOT need to implement this logic yourself.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>First we create a custom <code>HttpServletRequest</code> that returns a custom implementation of <code>HttpSession</code>.
It looks something like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public class SessionRepositoryRequestWrapper extends HttpServletRequestWrapper {

	public SessionRepositoryRequestWrapper(HttpServletRequest original) {
		super(original);
	}

	public HttpSession getSession() {
		return getSession(true);
	}

	public HttpSession getSession(boolean createNew) {
		// create an HttpSession implementation from Spring Session
	}

	// ... other methods delegate to the original HttpServletRequest ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Any method that returns an <code>HttpSession</code> is overridden.
All other methods are implemented by <code>HttpServletRequestWrapper</code> and simply delegate to the original <code>HttpServletRequest</code> implementation.</p>
</div>
<div class="paragraph">
<p>We replace the <code>HttpServletRequest</code> implementation using a servlet <code>Filter</code> called <code>SessionRepositoryFilter</code>.
The pseudocode can be found below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public class SessionRepositoryFilter implements Filter {

	public doFilter(ServletRequest request, ServletResponse response, FilterChain chain) {
		HttpServletRequest httpRequest = (HttpServletRequest) request;
		SessionRepositoryRequestWrapper customRequest =
			new SessionRepositoryRequestWrapper(httpRequest);

		chain.doFilter(customRequest, response, chain);
	}

	// ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By passing in a custom <code>HttpServletRequest</code> implementation into the <code>FilterChain</code> we ensure that anything invoked after our <code>Filter</code> uses the custom <code>HttpSession</code> implementation.
This highlights why it is important that Spring Session&#8217;s <code>SessionRepositoryFilter</code> must be placed before anything that interacts with the <code>HttpSession</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-rest"><a class="anchor" href="index.html#httpsession-rest"></a>5.6. HttpSession &amp; RESTful APIs</h3>
<div class="paragraph">
<p>Spring Session can work with RESTful APIs by allowing the session to be provided in a header.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="index.html#samples">REST Sample</a> provides a working sample on how to use Spring Session in a REST application to support authenticating with a header.
You can follow the basic steps for integration below, but you are encouraged to follow along with the detailed REST Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="rest-spring-configuration"><a class="anchor" href="index.html#rest-spring-configuration"></a>5.6.1. Spring Configuration</h4>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a Servlet Filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
Add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Configuration
@EnableRedisHttpSession <i class="conum" data-value="1"></i><b>(1)</b>
public class HttpSessionConfig {

	@Bean
	public LettuceConnectionFactory connectionFactory() {
		return new LettuceConnectionFactory(); <i class="conum" data-value="2"></i><b>(2)</b>
	}

	@Bean
	public HttpSessionIdResolver httpSessionIdResolver() {
		return HeaderHttpSessionIdResolver.xAuthToken(); <i class="conum" data-value="3"></i><b>(3)</b>
	}
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@EnableRedisHttpSession</code> annotation creates a Spring Bean with the name of <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The filter is what is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance Spring Session is backed by Redis.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a <code>RedisConnectionFactory</code> that connects Spring Session to the Redis Server.
We configure the connection to connect to localhost on the default port (6379)
For more information on configuring Spring Data Redis, refer to the <a href="https://docs.spring.io/spring-data/data-redis/docs/2.0.4.RELEASE/reference/html/">reference documentation</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We customize Spring Session&#8217;s HttpSession integration to use HTTP headers to convey the current session information instead of cookies.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="servlet-container-initialization-2"><a class="anchor" href="index.html#servlet-container-initialization-2"></a>5.6.2. Servlet Container Initialization</h4>
<div class="paragraph">
<p>Our <a href="index.html#rest-spring-configuration">Spring Configuration</a> created a Spring Bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, Spring needs to load our <code>Config</code> class. We provide the configuration in our Spring <code>MvcInitializer</code> as shown below:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/sample/mvc/MvcInitializer.java</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Override
protected Class&lt;?&gt;[] getRootConfigClasses() {
	return new Class[] { SecurityConfig.class, HttpSessionConfig.class };
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Last we need to ensure that our Servlet Container (i.e. Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
Fortunately, Spring Session provides a utility class named <code>AbstractHttpSessionApplicationInitializer</code> that makes this extremely easy. Simply extend the class with the default constructor as shown below:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/sample/Initializer.java</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public class Initializer extends AbstractHttpSessionApplicationInitializer {

}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The name of our class (Initializer) does not matter. What is important is that we extend <code>AbstractHttpSessionApplicationInitializer</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-httpsessionlistener"><a class="anchor" href="index.html#httpsession-httpsessionlistener"></a>5.7. HttpSessionListener</h3>
<div class="paragraph">
<p>Spring Session supports <code>HttpSessionListener</code> by translating <code>SessionDestroyedEvent</code> and <code>SessionCreatedEvent</code> into <code>HttpSessionEvent</code> by declaring <code>SessionEventHttpSessionListenerAdapter</code>.
To use this support, you need to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ensure your <code>SessionRepository</code> implementation supports and is configured to fire <code>SessionDestroyedEvent</code> and <code>SessionCreatedEvent</code>.</p>
</li>
<li>
<p>Configure <code>SessionEventHttpSessionListenerAdapter</code> as a Spring bean.</p>
</li>
<li>
<p>Inject every <code>HttpSessionListener</code> into the <code>SessionEventHttpSessionListenerAdapter</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you are using the configuration support documented in <a href="index.html#httpsession-redis">HttpSession with Redis</a>, then all you need to do is register every <code>HttpSessionListener</code> as a bean.
For example, assume you want to support Spring Security&#8217;s concurrency control and need to use <code>HttpSessionEventPublisher</code> you can simply add <code>HttpSessionEventPublisher</code> as a bean.
In Java configuration, this might look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Configuration
@EnableRedisHttpSession
public class RedisHttpSessionConfig {

	@Bean
	public HttpSessionEventPublisher httpSessionEventPublisher() {
		return new HttpSessionEventPublisher();
	}

	// ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In XML configuration, this might look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;bean class="org.springframework.security.web.session.HttpSessionEventPublisher"/&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="websocket"><a class="anchor" href="index.html#websocket"></a>6. WebSocket Integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Session provides transparent integration with Spring&#8217;s WebSocket support.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Spring Session&#8217;s WebSocket support only works with Spring&#8217;s WebSocket support.
Specifically it does not work with using <a href="https://www.jcp.org/en/jsr/detail?id=356">JSR-356</a> directly.
This is due to the fact that JSR-356 does not have a mechanism for intercepting incoming WebSocket messages.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="websocket-why"><a class="anchor" href="index.html#websocket-why"></a>6.1. Why Spring Session &amp; WebSockets?</h3>
<div class="paragraph">
<p>So why do we need Spring Session when using WebSockets?</p>
</div>
<div class="paragraph">
<p>Consider an email application that does much of its work through HTTP requests.
However, there is also a chat application embedded within it that works over WebSocket APIs.
If a user is actively chatting with someone, we should not timeout the <code>HttpSession</code> since this would be pretty poor user experience.
However, this is exactly what <a href="https://java.net/jira/browse/WEBSOCKET_SPEC-175">JSR-356</a> does.</p>
</div>
<div class="paragraph">
<p>Another issue is that according to JSR-356 if the <code>HttpSession</code> times out any WebSocket that was created with that HttpSession and an authenticated user should be forcibly closed.
This means that if we are actively chatting in our application and are not using the HttpSession, then we will also disconnect from our conversation!</p>
</div>
</div>
<div class="sect2">
<h3 id="websocket-usage"><a class="anchor" href="index.html#websocket-usage"></a>6.2. WebSocket Usage</h3>
<div class="paragraph">
<p>The <a href="index.html#samples">WebSocket Sample</a> provides a working sample on how to integrate Spring Session with WebSockets.
You can follow the basic steps for integration below, but you are encouraged to follow along with the detailed WebSocket Guide when integrating with your own application:</p>
</div>
<div class="sect3">
<h4 id="websocket-httpsession"><a class="anchor" href="index.html#websocket-httpsession"></a>6.2.1. HttpSession Integration</h4>
<div class="paragraph">
<p>Before using WebSocket integration, you should be sure that you have <a href="index.html#httpsession">HttpSession Integration</a> working first.</p>
</div>
</div>
<div class="sect3">
<h4 id="websocket-spring-configuration"><a class="anchor" href="index.html#websocket-spring-configuration"></a>6.2.2. Spring Configuration</h4>
<div class="paragraph">
<p>In a typical Spring WebSocket application users would implement <code>WebSocketMessageBrokerConfigurer</code>.
For example, the configuration might look something like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Configuration
@EnableScheduling
@EnableWebSocketMessageBroker
public class WebSocketConfig implements WebSocketMessageBrokerConfigurer {

	@Override
	public void registerStompEndpoints(StompEndpointRegistry registry) {
		registry.addEndpoint("/messages").withSockJS();
	}

	@Override
	public void configureMessageBroker(MessageBrokerRegistry registry) {
		registry.enableSimpleBroker("/queue/", "/topic/");
		registry.setApplicationDestinationPrefixes("/app");
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can easily update our configuration to use Spring Session&#8217;s WebSocket support.
For example:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/samples/config/WebSocketConfig.java</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Configuration
@EnableScheduling
@EnableWebSocketMessageBroker
public class WebSocketConfig
		extends AbstractSessionWebSocketMessageBrokerConfigurer&lt;Session&gt; { <i class="conum" data-value="1"></i><b>(1)</b>

	@Override
	protected void configureStompEndpoints(StompEndpointRegistry registry) { <i class="conum" data-value="2"></i><b>(2)</b>
		registry.addEndpoint("/messages").withSockJS();
	}

	@Override
	public void configureMessageBroker(MessageBrokerRegistry registry) {
		registry.enableSimpleBroker("/queue/", "/topic/");
		registry.setApplicationDestinationPrefixes("/app");
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To hook in the Spring Session support we only need to change two things:</p>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Instead of implementing <code>WebSocketMessageBrokerConfigurer</code> we extend <code>AbstractSessionWebSocketMessageBrokerConfigurer</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We rename the <code>registerStompEndpoints</code> method to <code>configureStompEndpoints</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>What does <code>AbstractSessionWebSocketMessageBrokerConfigurer</code> do behind the scenes?</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>WebSocketConnectHandlerDecoratorFactory</code> is added as a <code>WebSocketHandlerDecoratorFactory</code> to <code>WebSocketTransportRegistration</code>.
This ensures a custom <code>SessionConnectEvent</code> is fired that contains the <code>WebSocketSession</code>.
The <code>WebSocketSession</code> is necessary to terminate any WebSocket connections that are still open when a Spring Session is terminated.</p>
</li>
<li>
<p><code>SessionRepositoryMessageInterceptor</code> is added as a <code>HandshakeInterceptor</code> to every <code>StompWebSocketEndpointRegistration</code>.
This ensures that the Session is added to the WebSocket properties to enable updating the last accessed time.</p>
</li>
<li>
<p><code>SessionRepositoryMessageInterceptor</code> is added as a <code>ChannelInterceptor</code> to our inbound <code>ChannelRegistration</code>.
This ensures that every time an inbound message is received, that the last accessed time of our Spring Session is updated.</p>
</li>
<li>
<p><code>WebSocketRegistryListener</code> is created as a Spring Bean.
This ensures that we have a mapping of all of the Session id to the corresponding WebSocket connections.
By maintaining this mapping, we can close all the WebSocket connections when a Spring Session (HttpSession) is terminated.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="websession"><a class="anchor" href="index.html#websession"></a>7. WebSession Integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Session provides transparent integration with Spring WebFlux&#8217;s <code>WebSession</code>.
This means that developers can switch the <code>WebSession</code> implementation out with an implementation that is backed by Spring Session.</p>
</div>
<div class="sect2">
<h3 id="websession-why"><a class="anchor" href="index.html#websession-why"></a>7.1. Why Spring Session &amp; WebSession?</h3>
<div class="paragraph">
<p>We have already mentioned that Spring Session provides transparent integration with Spring WebFlux&#8217;s <code>WebSession</code>, but what benefits do we get out of this?
As with <code>HttpSession</code>, Spring Session makes it trivial to support <a href="index.html#websession-redis">clustered sessions</a> without being tied to an application container specific solution.</p>
</div>
</div>
<div class="sect2">
<h3 id="websession-redis"><a class="anchor" href="index.html#websession-redis"></a>7.2. WebSession with Redis</h3>
<div class="paragraph">
<p>Using Spring Session with <code>WebSession</code> is enabled by simply registering a <code>WebSessionManager</code> implementation backed by Spring Session&#8217;s <code>ReactiveSessionRepository</code>.
The Spring configuration is responsible for creating a <code>WebSessionManager</code> that replaces the <code>WebSession</code> implementation with an implementation backed by Spring Session.
Add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@EnableRedisWebSession <i class="conum" data-value="1"></i><b>(1)</b>
public class SessionConfiguration {

	@Bean
	public LettuceConnectionFactory redisConnectionFactory() {
		return new LettuceConnectionFactory(); <i class="conum" data-value="2"></i><b>(2)</b>
	}

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@EnableRedisWebSession</code> annotation creates a Spring Bean with the name of <code>webSessionManager</code> that implements the <code>WebSessionManager</code>.
This is what is in charge of replacing the <code>WebSession</code> implementation to be backed by Spring Session.
In this instance Spring Session is backed by Redis.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a <code>RedisConnectionFactory</code> that connects Spring Session to the Redis Server.
We configure the connection to connect to localhost on the default port (6379)
For more information on configuring Spring Data Redis, refer to the <a href="https://docs.spring.io/spring-data/data-redis/docs/2.0.4.RELEASE/reference/html/">reference documentation</a>.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="websession-how"><a class="anchor" href="index.html#websession-how"></a>7.3. How WebSession Integration Works</h3>
<div class="paragraph">
<p>With Spring WebFlux and it&#8217;s <code>WebSession</code> things are considerably simpler for Spring Session to integrate with, compared to Servlet API and it&#8217;s <code>HttpSession</code>.
Spring WebFlux provides <code>WebSessionStore</code> API which presents a strategy for persisting <code>WebSession</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This section describes how Spring Session provides transparent integration with <code>WebSession</code>. The intent is so that user&#8217;s can understand what is happening under the covers. This functionality is already integrated and you do NOT need to implement this logic yourself.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>First we create a custom <code>SpringSessionWebSession</code> that delegates to Spring Session&#8217;s <code>Session</code>.
It looks something like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public class SpringSessionWebSession implements WebSession {

	enum State {
		NEW, STARTED
	}

	private final S session;

	private AtomicReference&lt;State&gt; state = new AtomicReference&lt;&gt;();

	SpringSessionWebSession(S session, State state) {
		this.session = session;
		this.state.set(state);
	}

	@Override
	public void start() {
		this.state.compareAndSet(State.NEW, State.STARTED);
	}

	@Override
	public boolean isStarted() {
		State value = this.state.get();
		return (State.STARTED.equals(value)
				|| (State.NEW.equals(value) &amp;&amp; !this.session.getAttributes().isEmpty()));
	}

	@Override
	public Mono&lt;Void&gt; changeSessionId() {
		return Mono.defer(() -&gt; {
			this.session.changeSessionId();
			return save();
		});
	}

	// ... other methods delegate to the original Session
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, we create a custom <code>WebSessionStore</code> that delegates to the <code>ReactiveSessionRepository</code> and wraps <code>Session</code> into custom <code>WebSession</code> implementation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public class SpringSessionWebSessionStore&lt;S extends Session&gt; implements WebSessionStore {

	private final ReactiveSessionRepository&lt;S&gt; sessions;

	public SpringSessionWebSessionStore(ReactiveSessionRepository&lt;S&gt; reactiveSessionRepository) {
		this.sessions = reactiveSessionRepository;
	}

	// ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to be detected by Spring WebFlux, this custom <code>WebSessionStore</code> needs to be registered with <code>ApplicationContext</code> as bean named <code>webSessionManager</code>.
For additional information on Spring WebFlux, refer to the <a href="https://docs.spring.io/spring/docs/5.0.4.RELEASE/spring-framework-reference/web-reactive.html">Spring Framework Reference Documentation</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-security"><a class="anchor" href="index.html#spring-security"></a>8. Spring Security Integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Session provides integration with Spring Security.</p>
</div>
<div class="sect2">
<h3 id="spring-security-rememberme"><a class="anchor" href="index.html#spring-security-rememberme"></a>8.1. Spring Security Remember-Me Support</h3>
<div class="paragraph">
<p>Spring Session provides integration with <a href="https://docs.spring.io/spring-security/site/docs/5.0.2.RELEASE/reference/htmlsingle/#remember-me">Spring Security&#8217;s Remember-Me Authentication</a>.
The support will:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Change the session expiration length</p>
</li>
<li>
<p>Ensure the session cookie expires at <code>Integer.MAX_VALUE</code>.
The cookie expiration is set to the largest possible value because the cookie is only set when the session is created.
If it were set to the same value as the session expiration, then the session would get renewed when the user used it but the cookie expiration would not be updated causing the expiration to be fixed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To configure Spring Session with Spring Security in Java Configuration use the following as a guide:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Override
protected void configure(HttpSecurity http) throws Exception {
	http
		// ... additional configuration ...
		.rememberMe()
			.rememberMeServices(rememberMeServices());
}

@Bean
RememberMeServices rememberMeServices() {
	SpringSessionRememberMeServices rememberMeServices =
			new SpringSessionRememberMeServices();
	// optionally customize
	rememberMeServices.setAlwaysRemember(true);
	return rememberMeServices;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An XML based configuration would look something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;security:http&gt;
	&lt;!-- ... --&gt;
	&lt;security:form-login /&gt;
	&lt;security:remember-me services-ref="rememberMeServices"/&gt;
&lt;/security:http&gt;

&lt;bean id="rememberMeServices"
	class="org.springframework.session.security.web.authentication.SpringSessionRememberMeServices"
	p:alwaysRemember="true"/&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="spring-security-concurrent-sessions"><a class="anchor" href="index.html#spring-security-concurrent-sessions"></a>8.2. Spring Security Concurrent Session Control</h3>
<div class="paragraph">
<p>Spring Session provides integration with Spring Security to support its concurrent session control.
This allows limiting the number of active sessions that a single user can have concurrently, but unlike the default
Spring Security support this will also work in a clustered environment. This is done by providing a custom
implementation of Spring Security&#8217;s <code>SessionRegistry</code> interface.</p>
</div>
<div class="paragraph">
<p>When using Spring Security&#8217;s Java config DSL, you can configure the custom <code>SessionRegistry</code> through the
<code>SessionManagementConfigurer</code> like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Configuration
public class SecurityConfiguration extends WebSecurityConfigurerAdapter {

	@Autowired
	private FindByIndexNameSessionRepository&lt;Session&gt; sessionRepository;

	@Override
	protected void configure(HttpSecurity http) throws Exception {
		// @formatter:off
		http
			// other config goes here...
			.sessionManagement()
				.maximumSessions(2)
				.sessionRegistry(sessionRegistry());
		// @formatter:on
	}

	@Bean
	SpringSessionBackedSessionRegistry sessionRegistry() {
		return new SpringSessionBackedSessionRegistry&lt;&gt;(this.sessionRepository);
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This assumes that you&#8217;ve also configured Spring Session to provide a <code>FindByIndexNameSessionRepository</code> that
returns <code>Session</code> instances.</p>
</div>
<div class="paragraph">
<p>When using XML configuration, it would look something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;security:http&gt;
	&lt;!-- other config goes here... --&gt;
	&lt;security:session-management&gt;
		&lt;security:concurrency-control max-sessions="2" session-registry-ref="sessionRegistry"/&gt;
	&lt;/security:session-management&gt;
&lt;/security:http&gt;

&lt;bean id="sessionRegistry"
	  class="org.springframework.session.security.SpringSessionBackedSessionRegistry"&gt;
	&lt;constructor-arg ref="sessionRepository"/&gt;
&lt;/bean&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This assumes that your Spring Session <code>SessionRegistry</code> bean is called <code>sessionRegistry</code>, which is the name used by all
<code>SpringHttpSessionConfiguration</code> subclasses.</p>
</div>
</div>
<div class="sect2">
<h3 id="spring-security-concurrent-sessions-limitations"><a class="anchor" href="index.html#spring-security-concurrent-sessions-limitations"></a>8.3. Limitations</h3>
<div class="paragraph">
<p>Spring Session&#8217;s implementation of Spring Security&#8217;s <code>SessionRegistry</code> interface does not support the <code>getAllPrincipals</code>
method, as this information cannot be retrieved using Spring Session. This method is never called by Spring Security,
so this only affects applications that access the <code>SessionRegistry</code> themselves.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api"><a class="anchor" href="index.html#api"></a>9. API Documentation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can browse the complete <a href="https://docs.spring.io/spring-session/docs/current/api/">Javadoc</a> online. The key APIs are described below:</p>
</div>
<div class="sect2">
<h3 id="api-session"><a class="anchor" href="index.html#api-session"></a>9.1. Session</h3>
<div class="paragraph">
<p>A <code>Session</code> is a simplified <code>Map</code> of name value pairs.</p>
</div>
<div class="paragraph">
<p>Typical usage might look like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public class RepositoryDemo&lt;S extends Session&gt; {
	private SessionRepository&lt;S&gt; repository; <i class="conum" data-value="1"></i><b>(1)</b>

	public void demo() {
		S toSave = this.repository.createSession(); <i class="conum" data-value="2"></i><b>(2)</b>

		<i class="conum" data-value="3"></i><b>(3)</b>
		User rwinch = new User("rwinch");
		toSave.setAttribute(ATTR_USER, rwinch);

		this.repository.save(toSave); <i class="conum" data-value="4"></i><b>(4)</b>

		S session = this.repository.findById(toSave.getId()); <i class="conum" data-value="5"></i><b>(5)</b>

		<i class="conum" data-value="6"></i><b>(6)</b>
		User user = session.getAttribute(ATTR_USER);
		assertThat(user).isEqualTo(rwinch);
	}

	// ... setter methods ...
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We create a <code>SessionRepository</code> instance with a generic type, <code>S</code>, that extends <code>Session</code>. The generic type is defined in our class.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a new <code>Session</code> using our <code>SessionRepository</code> and assign it to a variable of type <code>S</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We interact with the <code>Session</code>. In our example, we demonstrate saving a <code>User</code> to the <code>Session</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We now save the <code>Session</code>. This is why we needed the generic type <code>S</code>. The <code>SessionRepository</code> only allows saving <code>Session</code> instances that were created or retrieved using the same <code>SessionRepository</code>. This allows for the <code>SessionRepository</code> to make implementation specific optimizations (i.e. only writing attributes that have changed).</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>We retrieve the <code>Session</code> from the <code>SessionRepository</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>We obtain the persisted <code>User</code> from our <code>Session</code> without the need for explicitly casting our attribute.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>Session</code> API also provides attributes related to the <code>Session</code> instance&#8217;s expiration.</p>
</div>
<div class="paragraph">
<p>Typical usage might look like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public class ExpiringRepositoryDemo&lt;S extends Session&gt; {
	private SessionRepository&lt;S&gt; repository; <i class="conum" data-value="1"></i><b>(1)</b>

	public void demo() {
		S toSave = this.repository.createSession(); <i class="conum" data-value="2"></i><b>(2)</b>
		// ...
		toSave.setMaxInactiveInterval(Duration.ofSeconds(30)); <i class="conum" data-value="3"></i><b>(3)</b>

		this.repository.save(toSave); <i class="conum" data-value="4"></i><b>(4)</b>

		S session = this.repository.findById(toSave.getId()); <i class="conum" data-value="5"></i><b>(5)</b>
		// ...
	}

	// ... setter methods ...
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We create a <code>SessionRepository</code> instance with a generic type, <code>S</code>, that extends <code>Session</code>. The generic type is defined in our class.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a new <code>Session</code> using our <code>SessionRepository</code> and assign it to a variable of type <code>S</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We interact with the <code>Session</code>.
In our example, we demonstrate updating the amount of time the <code>Session</code> can be inactive before it expires.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We now save the <code>Session</code>.
This is why we needed the generic type <code>S</code>.
The <code>SessionRepository</code> only allows saving <code>Session</code> instances that were created or retrieved using the same <code>SessionRepository</code>.
This allows for the <code>SessionRepository</code> to make implementation specific optimizations (i.e. only writing attributes that have changed).
The last accessed time is automatically updated when the <code>Session</code> is saved.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>We retrieve the <code>Session</code> from the <code>SessionRepository</code>.
If the <code>Session</code> were expired, the result would be null.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="api-sessionrepository"><a class="anchor" href="index.html#api-sessionrepository"></a>9.2. SessionRepository</h3>
<div class="paragraph">
<p>A <code>SessionRepository</code> is in charge of creating, retrieving, and persisting <code>Session</code> instances.</p>
</div>
<div class="paragraph">
<p>If possible, developers should not interact directly with a <code>SessionRepository</code> or a <code>Session</code>.
Instead, developers should prefer interacting with <code>SessionRepository</code> and <code>Session</code> indirectly through the <a href="index.html#httpsession">HttpSession</a> and <a href="index.html#websocket">WebSocket</a> integration.</p>
</div>
</div>
<div class="sect2">
<h3 id="api-findbyindexnamesessionrepository"><a class="anchor" href="index.html#api-findbyindexnamesessionrepository"></a>9.3. FindByIndexNameSessionRepository</h3>
<div class="paragraph">
<p>Spring Session&#8217;s most basic API for using a <code>Session</code> is the <code>SessionRepository</code>.
This API is intentionally very simple, so that it is easy to provide additional implementations with basic functionality.</p>
</div>
<div class="paragraph">
<p>Some <code>SessionRepository</code> implementations may choose to implement <code>FindByIndexNameSessionRepository</code> also.
For example, Spring&#8217;s Redis support implements <code>FindByIndexNameSessionRepository</code>.</p>
</div>
<div class="paragraph">
<p>The <code>FindByIndexNameSessionRepository</code> adds a single method to look up all the sessions for a particular user.
This is done by ensuring that the session attribute with the name <code>FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME</code> is populated with the username.
It is the responsibility of the developer to ensure the attribute is populated since Spring Session is not aware of the authentication mechanism being used.
An example of how this might be used can be seen below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">String username = "username";
this.session.setAttribute(
		FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME, username);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Some implementations of <code>FindByIndexNameSessionRepository</code> will provide hooks to automatically index other session attributes.
For example, many implementations will automatically ensure the current Spring Security user name is indexed with the index name <code>FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once the session is indexed, it can be found using the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">String username = "username";
Map&lt;String, Session&gt; sessionIdToSession = this.sessionRepository
		.findByIndexNameAndIndexValue(
				FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME,
				username);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-reactivesessionrepository"><a class="anchor" href="index.html#api-reactivesessionrepository"></a>9.4. ReactiveSessionRepository</h3>
<div class="paragraph">
<p>A <code>ReactiveSessionRepository</code> is in charge of creating, retrieving, and persisting <code>Session</code> instances in a non-blocking and reactive manner.</p>
</div>
<div class="paragraph">
<p>If possible, developers should not interact directly with a <code>ReactiveSessionRepository</code> or a <code>Session</code>.
Instead, developers should prefer interacting with <code>ReactiveSessionRepository</code> and <code>Session</code> indirectly through the <a href="index.html#websession">WebSession</a> integration.</p>
</div>
</div>
<div class="sect2">
<h3 id="api-enablespringhttpsession"><a class="anchor" href="index.html#api-enablespringhttpsession"></a>9.5. EnableSpringHttpSession</h3>
<div class="paragraph">
<p>The <code>@EnableSpringHttpSession</code> annotation can be added to an <code>@Configuration</code> class to expose the <code>SessionRepositoryFilter</code> as a bean named "springSessionRepositoryFilter".
In order to leverage the annotation, a single <code>SessionRepository</code> bean must be provided.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@EnableSpringHttpSession
@Configuration
public class SpringHttpSessionConfig {
	@Bean
	public MapSessionRepository sessionRepository() {
		return new MapSessionRepository(new ConcurrentHashMap&lt;&gt;());
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is important to note that no infrastructure for session expirations is configured for you out of the box.
This is because things like session expiration are highly implementation dependent.
This means if you require cleaning up expired sessions, you are responsible for cleaning up the expired sessions.</p>
</div>
</div>
<div class="sect2">
<h3 id="api-enablespringwebsession"><a class="anchor" href="index.html#api-enablespringwebsession"></a>9.6. EnableSpringWebSession</h3>
<div class="paragraph">
<p>The <code>@EnableSpringWebSession</code> annotation can be added to an <code>@Configuration</code> class to expose the <code>WebSessionManager</code> as a bean named "webSessionManager".
In order to leverage the annotation, a single <code>ReactiveSessionRepository</code> bean must be provided.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@EnableSpringWebSession
public class SpringWebSessionConfig {
	@Bean
	public ReactiveSessionRepository reactiveSessionRepository() {
		return new ReactiveMapSessionRepository(new ConcurrentHashMap&lt;&gt;());
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is important to note that no infrastructure for session expirations is configured for you out of the box.
This is because things like session expiration are highly implementation dependent.
This means if you require cleaning up expired sessions, you are responsible for cleaning up the expired sessions.</p>
</div>
</div>
<div class="sect2">
<h3 id="api-redisoperationssessionrepository"><a class="anchor" href="index.html#api-redisoperationssessionrepository"></a>9.7. RedisOperationsSessionRepository</h3>
<div class="paragraph">
<p><code>RedisOperationsSessionRepository</code> is a <code>SessionRepository</code> that is implemented using Spring Data&#8217;s <code>RedisOperations</code>.
In a web environment, this is typically used in combination with <code>SessionRepositoryFilter</code>.
The implementation supports <code>SessionDestroyedEvent</code> and <code>SessionCreatedEvent</code> through <code>SessionMessageListener</code>.</p>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-new"><a class="anchor" href="index.html#api-redisoperationssessionrepository-new"></a>9.7.1. Instantiating a RedisOperationsSessionRepository</h4>
<div class="paragraph">
<p>A typical example of how to create a new instance can be seen below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">RedisTemplate&lt;Object, Object&gt; redisTemplate = new RedisTemplate&lt;&gt;();

// ... configure redisTemplate ...

SessionRepository&lt;? extends Session&gt; repository =
		new RedisOperationsSessionRepository(redisTemplate);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For additional information on how to create a <code>RedisConnectionFactory</code>, refer to the Spring Data Redis Reference.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-config"><a class="anchor" href="index.html#api-redisoperationssessionrepository-config"></a>9.7.2. EnableRedisHttpSession</h4>
<div class="paragraph">
<p>In a web environment, the simplest way to create a new <code>RedisOperationsSessionRepository</code> is to use <code>@EnableRedisHttpSession</code>.
Complete example usage can be found in the <a href="index.html#samples">Samples and Guides (Start Here)</a>
You can use the following attributes to customize the configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>maxInactiveIntervalInSeconds</strong> - the amount of time before the session will expire in seconds</p>
</li>
<li>
<p><strong>redisNamespace</strong> - allows configuring an application specific namespace for the sessions. Redis keys and channel IDs will start with the prefix of <code>&lt;redisNamespace&gt;:</code>.</p>
</li>
<li>
<p><strong>redisFlushMode</strong> - allows specifying when data will be written to Redis. The default is only when <code>save</code> is invoked on <code>SessionRepository</code>.
A value of <code>RedisFlushMode.IMMEDIATE</code> will write to Redis as soon as possible.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="custom-redisserializer"><a class="anchor" href="index.html#custom-redisserializer"></a>Custom RedisSerializer</h5>
<div class="paragraph">
<p>You can customize the serialization by creating a Bean named <code>springSessionDefaultRedisSerializer</code> that implements <code>RedisSerializer&lt;Object&gt;</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="redis-taskexecutor"><a class="anchor" href="index.html#redis-taskexecutor"></a>9.7.3. Redis TaskExecutor</h4>
<div class="paragraph">
<p><code>RedisOperationsSessionRepository</code> is subscribed to receive events from redis using a <code>RedisMessageListenerContainer</code>.
You can customize the way those events are dispatched, by creating a Bean named <code>springSessionRedisTaskExecutor</code> and/or a Bean <code>springSessionRedisSubscriptionExecutor</code>.
More details on configuring redis task executors can be found <a href="https://docs.spring.io/spring-data-redis/docs/2.0.4.RELEASE/reference/html/#redis:pubsub:subscribe:containers">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-storage"><a class="anchor" href="index.html#api-redisoperationssessionrepository-storage"></a>9.7.4. Storage Details</h4>
<div class="paragraph">
<p>The sections below outline how Redis is updated for each operation.
An example of creating a new session can be found below.
The subsequent sections describe the details.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>HMSET spring:session:sessions:33fdd1b6-b496-4b33-9f7d-df96679d32fe creationTime 1404360000000 \
	maxInactiveInterval 1800 \
	lastAccessedTime 1404360000000 \
	sessionAttr:attrName someAttrValue \
	sessionAttr2:attrName someAttrValue2
EXPIRE spring:session:sessions:33fdd1b6-b496-4b33-9f7d-df96679d32fe 2100
APPEND spring:session:sessions:expires:33fdd1b6-b496-4b33-9f7d-df96679d32fe ""
EXPIRE spring:session:sessions:expires:33fdd1b6-b496-4b33-9f7d-df96679d32fe 1800
SADD spring:session:expirations:1439245080000 expires:33fdd1b6-b496-4b33-9f7d-df96679d32fe
EXPIRE spring:session:expirations1439245080000 2100</pre>
</div>
</div>
<div class="sect4">
<h5 id="saving-a-session"><a class="anchor" href="index.html#saving-a-session"></a>Saving a Session</h5>
<div class="paragraph">
<p>Each session is stored in Redis as a Hash.
Each session is set and updated using the HMSET command.
An example of how each session is stored can be seen below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>HMSET spring:session:sessions:33fdd1b6-b496-4b33-9f7d-df96679d32fe creationTime 1404360000000 \
	maxInactiveInterval 1800 \
	lastAccessedTime 1404360000000 \
	sessionAttr:attrName someAttrValue \
	sessionAttr2:attrName someAttrValue2</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the session following statements are true about the session:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The session ID is 33fdd1b6-b496-4b33-9f7d-df96679d32fe</p>
</li>
<li>
<p>The session was created at 1404360000000 in milliseconds since midnight of 1/1/1970 GMT.</p>
</li>
<li>
<p>The session expires in 1800 seconds (30 minutes).</p>
</li>
<li>
<p>The session was last accessed at 1404360000000 in milliseconds since midnight of 1/1/1970 GMT.</p>
</li>
<li>
<p>The session has two attributes.
The first is "attrName" with the value of "someAttrValue".
The second session attribute is named "attrName2" with the value of "someAttrValue2".</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="api-redisoperationssessionrepository-writes"><a class="anchor" href="index.html#api-redisoperationssessionrepository-writes"></a>Optimized Writes</h5>
<div class="paragraph">
<p>The <code>Session</code> instances managed by <code>RedisOperationsSessionRepository</code> keeps track of the properties that have changed and only updates those.
This means if an attribute is written once and read many times we only need to write that attribute once.
For example, assume the session attribute "sessionAttr2" from earlier was updated.
The following would be executed upon saving:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>HMSET spring:session:sessions:33fdd1b6-b496-4b33-9f7d-df96679d32fe sessionAttr:attrName2 newValue</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-redisoperationssessionrepository-expiration"><a class="anchor" href="index.html#api-redisoperationssessionrepository-expiration"></a>Session Expiration</h5>
<div class="paragraph">
<p>An expiration is associated to each session using the EXPIRE command based upon the <code>Session.getMaxInactiveInterval()</code>.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>EXPIRE spring:session:sessions:33fdd1b6-b496-4b33-9f7d-df96679d32fe 2100</pre>
</div>
</div>
<div class="paragraph">
<p>You will note that the expiration that is set is 5 minutes after the session actually expires.
This is necessary so that the value of the session can be accessed when the session expires.
An expiration is set on the session itself five minutes after it actually expires to ensure it is cleaned up, but only after we perform any necessary processing.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>SessionRepository.findById(String)</code> method ensures that no expired sessions will be returned.
This means there is no need to check the expiration before using a session.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Spring Session relies on the delete and expired <a href="https://redis.io/topics/notifications">keyspace notifications</a> from Redis to fire a <a href="index.html#api-redisoperationssessionrepository-sessiondestroyedevent">SessionDeletedEvent</a> and <a href="index.html#api-redisoperationssessionrepository-sessiondestroyedevent">SessionExpiredEvent</a> respectively.
It is the <code>SessionDeletedEvent</code> or <code>SessionExpiredEvent</code> that ensures resources associated with the Session are cleaned up.
For example, when using Spring Session&#8217;s WebSocket support the Redis expired or delete event is what triggers any WebSocket connections associated with the session to be closed.</p>
</div>
<div class="paragraph">
<p>Expiration is not tracked directly on the session key itself since this would mean the session data would no longer be available. Instead a special session expires key is used. In our example the expires key is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>APPEND spring:session:sessions:expires:33fdd1b6-b496-4b33-9f7d-df96679d32fe ""
EXPIRE spring:session:sessions:expires:33fdd1b6-b496-4b33-9f7d-df96679d32fe 1800</pre>
</div>
</div>
<div class="paragraph">
<p>When a session expires key is deleted or expires, the keyspace notification triggers a lookup of the actual session and a SessionDestroyedEvent is fired.</p>
</div>
<div class="paragraph">
<p>One problem with relying on Redis expiration exclusively is that Redis makes no guarantee of when the expired event will be fired if the key has not been accessed.
Specifically the background task that Redis uses to clean up expired keys is a low priority task and may not trigger the key expiration.
For additional details see <a href="https://redis.io/topics/notifications">Timing of expired events</a> section in the Redis documentation.</p>
</div>
<div class="paragraph">
<p>To circumvent the fact that expired events are not guaranteed to happen we can ensure that each key is accessed when it is expected to expire.
This means that if the TTL is expired on the key, Redis will remove the key and fire the expired event when we try to access the key.</p>
</div>
<div class="paragraph">
<p>For this reason, each session expiration is also tracked to the nearest minute.
This allows a background task to access the potentially expired sessions to ensure that Redis expired events are fired in a more deterministic fashion.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SADD spring:session:expirations:1439245080000 expires:33fdd1b6-b496-4b33-9f7d-df96679d32fe
EXPIRE spring:session:expirations1439245080000 2100</pre>
</div>
</div>
<div class="paragraph">
<p>The background task will then use these mappings to explicitly request each key.
By accessing the key, rather than deleting it, we ensure that Redis deletes the key for us only if the TTL is expired.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We do not explicitly delete the keys since in some instances there may be a race condition that incorrectly identifies a key as expired when it is not.
Short of using distributed locks (which would kill our performance) there is no way to ensure the consistency of the expiration mapping.
By simply accessing the key, we ensure that the key is only removed if the TTL on that key is expired.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-sessiondestroyedevent"><a class="anchor" href="index.html#api-redisoperationssessionrepository-sessiondestroyedevent"></a>9.7.5. SessionDeletedEvent and SessionExpiredEvent</h4>
<div class="paragraph">
<p><code>SessionDeletedEvent</code> and <code>SessionExpiredEvent</code> are both types of <code>SessionDestroyedEvent</code>.</p>
</div>
<div class="paragraph">
<p><code>RedisOperationsSessionRepository</code> supports firing a <code>SessionDeletedEvent</code> whenever a <code>Session</code> is deleted or a <code>SessionExpiredEvent</code> when it expires.
This is necessary to ensure resources associated with the <code>Session</code> are properly cleaned up.</p>
</div>
<div class="paragraph">
<p>For example, when integrating with WebSockets the <code>SessionDestroyedEvent</code> is in charge of closing any active WebSocket connections.</p>
</div>
<div class="paragraph">
<p>Firing <code>SessionDeletedEvent</code> or <code>SessionExpiredEvent</code> is made available through the <code>SessionMessageListener</code> which listens to <a href="https://redis.io/topics/notifications">Redis Keyspace events</a>.
In order for this to work, Redis Keyspace events for Generic commands and Expired events needs to be enabled.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">redis-cli config set notify-keyspace-events Egx</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are using <code>@EnableRedisHttpSession</code> the <code>SessionMessageListener</code> and enabling the necessary Redis Keyspace events is done automatically.
However, in a secured Redis enviornment the config command is disabled.
This means that Spring Session cannot configure Redis Keyspace events for you.
To disable the automatic configuration add <code>ConfigureRedisAction.NO_OP</code> as a bean.</p>
</div>
<div class="paragraph">
<p>For example, Java Configuration can use the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Bean
public static ConfigureRedisAction configureRedisAction() {
	return ConfigureRedisAction.NO_OP;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>XML Configuration can use the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;util:constant
	static-field="org.springframework.session.data.redis.config.ConfigureRedisAction.NO_OP"/&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-sessioncreatedevent"><a class="anchor" href="index.html#api-redisoperationssessionrepository-sessioncreatedevent"></a>9.7.6. SessionCreatedEvent</h4>
<div class="paragraph">
<p>When a session is created an event is sent to Redis with the channel of <code>spring:session:channel:created:33fdd1b6-b496-4b33-9f7d-df96679d32fe</code>
such that <code>33fdd1b6-b496-4b33-9f7d-df96679d32fe</code> is the session ID. The body of the event will be the session that was created.</p>
</div>
<div class="paragraph">
<p>If registered as a MessageListener (default), then <code>RedisOperationsSessionRepository</code> will then translate the Redis message into a <code>SessionCreatedEvent</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-cli"><a class="anchor" href="index.html#api-redisoperationssessionrepository-cli"></a>9.7.7. Viewing the Session in Redis</h4>
<div class="paragraph">
<p>After <a href="https://redis.io/topics/quickstart">installing redis-cli</a>, you can inspect the values in Redis <a href="https://redis.io/commands#hash">using the redis-cli</a>.
For example, enter the following into a terminal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">$ redis-cli
redis 127.0.0.1:6379&gt; keys *
1) "spring:session:sessions:4fc39ce3-63b3-4e17-b1c4-5e1ed96fb021" <i class="conum" data-value="1"></i><b>(1)</b>
2) "spring:session:expirations:1418772300000" <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The suffix of this key is the session identifier of the Spring Session.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This key contains all the session IDs that should be deleted at the time <code>1418772300000</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can also view the attributes of each session.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">redis 127.0.0.1:6379&gt; hkeys spring:session:sessions:4fc39ce3-63b3-4e17-b1c4-5e1ed96fb021
1) "lastAccessedTime"
2) "creationTime"
3) "maxInactiveInterval"
4) "sessionAttr:username"
redis 127.0.0.1:6379&gt; hget spring:session:sessions:4fc39ce3-63b3-4e17-b1c4-5e1ed96fb021 sessionAttr:username
"\xac\xed\x00\x05t\x00\x03rob"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-reactiveredisoperationssessionrepository"><a class="anchor" href="index.html#api-reactiveredisoperationssessionrepository"></a>9.8. ReactiveRedisOperationsSessionRepository</h3>
<div class="paragraph">
<p><code>ReactiveRedisOperationsSessionRepository</code> is a <code>ReactiveSessionRepository</code> that is implemented using Spring Data&#8217;s <code>ReactiveRedisOperations</code>.
In a web environment, this is typically used in combination with <code>WebSessionStore</code>.</p>
</div>
<div class="sect3">
<h4 id="api-reactiveredisoperationssessionrepository-new"><a class="anchor" href="index.html#api-reactiveredisoperationssessionrepository-new"></a>9.8.1. Instantiating a ReactiveRedisOperationsSessionRepository</h4>
<div class="paragraph">
<p>A typical example of how to create a new instance can be seen below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">// ... create and configure connectionFactory and serializationContext ...

ReactiveRedisTemplate&lt;String, Object&gt; redisTemplate = new ReactiveRedisTemplate&lt;&gt;(
		connectionFactory, serializationContext);

ReactiveSessionRepository&lt;? extends Session&gt; repository =
		new ReactiveRedisOperationsSessionRepository(redisTemplate);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For additional information on how to create a <code>ReactiveRedisConnectionFactory</code>, refer to the Spring Data Redis Reference.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-reactiveredisoperationssessionrepository-config"><a class="anchor" href="index.html#api-reactiveredisoperationssessionrepository-config"></a>9.8.2. EnableRedisWebSession</h4>
<div class="paragraph">
<p>In a web environment, the simplest way to create a new <code>ReactiveRedisOperationsSessionRepository</code> is to use <code>@EnableRedisWebSession</code>.
You can use the following attributes to customize the configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>maxInactiveIntervalInSeconds</strong> - the amount of time before the session will expire in seconds</p>
</li>
<li>
<p><strong>redisNamespace</strong> - allows configuring an application specific namespace for the sessions. Redis keys and channel IDs will start with the prefix of <code>&lt;redisNamespace&gt;:</code>.</p>
</li>
<li>
<p><strong>redisFlushMode</strong> - allows specifying when data will be written to Redis. The default is only when <code>save</code> is invoked on <code>ReactiveSessionRepository</code>.
A value of <code>RedisFlushMode.IMMEDIATE</code> will write to Redis as soon as possible.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-reactiveredisoperationssessionrepository-writes"><a class="anchor" href="index.html#api-reactiveredisoperationssessionrepository-writes"></a>Optimized Writes</h5>
<div class="paragraph">
<p>The <code>Session</code> instances managed by <code>ReactiveRedisOperationsSessionRepository</code> keeps track of the properties that have changed and only updates those.
This means if an attribute is written once and read many times we only need to write that attribute once.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-reactiveredisoperationssessionrepository-cli"><a class="anchor" href="index.html#api-reactiveredisoperationssessionrepository-cli"></a>9.8.3. Viewing the Session in Redis</h4>
<div class="paragraph">
<p>After <a href="https://redis.io/topics/quickstart">installing redis-cli</a>, you can inspect the values in Redis <a href="https://redis.io/commands#hash">using the redis-cli</a>.
For example, enter the following into a terminal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">$ redis-cli
redis 127.0.0.1:6379&gt; keys *
1) "spring:session:sessions:4fc39ce3-63b3-4e17-b1c4-5e1ed96fb021" <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The suffix of this key is the session identifier of the Spring Session.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can also view the attributes of each session.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">redis 127.0.0.1:6379&gt; hkeys spring:session:sessions:4fc39ce3-63b3-4e17-b1c4-5e1ed96fb021
1) "lastAccessedTime"
2) "creationTime"
3) "maxInactiveInterval"
4) "sessionAttr:username"
redis 127.0.0.1:6379&gt; hget spring:session:sessions:4fc39ce3-63b3-4e17-b1c4-5e1ed96fb021 sessionAttr:username
"\xac\xed\x00\x05t\x00\x03rob"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-mapsessionrepository"><a class="anchor" href="index.html#api-mapsessionrepository"></a>9.9. MapSessionRepository</h3>
<div class="paragraph">
<p>The <code>MapSessionRepository</code> allows for persisting <code>Session</code> in a <code>Map</code> with the key being the <code>Session</code> ID and the value being the <code>Session</code>.
The implementation can be used with a <code>ConcurrentHashMap</code> as a testing or convenience mechanism.
Alternatively, it can be used with distributed <code>Map</code> implementations. For example, it can be used with Hazelcast.</p>
</div>
<div class="sect3">
<h4 id="api-mapsessionrepository-new"><a class="anchor" href="index.html#api-mapsessionrepository-new"></a>9.9.1. Instantiating MapSessionRepository</h4>
<div class="paragraph">
<p>Creating a new instance is as simple as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">SessionRepository&lt;? extends Session&gt; repository = new MapSessionRepository(
		new ConcurrentHashMap&lt;&gt;());</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-mapsessionrepository-hazelcast"><a class="anchor" href="index.html#api-mapsessionrepository-hazelcast"></a>9.9.2. Using Spring Session and Hazlecast</h4>
<div class="paragraph">
<p>The <a href="index.html#samples">Hazelcast Sample</a> is a complete application demonstrating using Spring Session with Hazelcast.</p>
</div>
<div class="paragraph">
<p>To run it use the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./gradlew :samples:hazelcast:tomcatRun</pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="index.html#samples">Hazelcast Spring Sample</a> is a complete application demonstrating using Spring Session with Hazelcast and Spring Security.</p>
</div>
<div class="paragraph">
<p>It includes example Hazelcast <code>MapListener</code> implementations that support firing <code>SessionCreatedEvent</code>, <code>SessionDeletedEvent</code> and <code>SessionExpiredEvent</code>.</p>
</div>
<div class="paragraph">
<p>To run it use the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./gradlew :samples:hazelcast-spring:tomcatRun</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-reactivemapsessionrepository"><a class="anchor" href="index.html#api-reactivemapsessionrepository"></a>9.10. ReactiveMapSessionRepository</h3>
<div class="paragraph">
<p>The <code>ReactiveMapSessionRepository</code> allows for persisting <code>Session</code> in a <code>Map</code> with the key being the <code>Session</code> ID and the value being the <code>Session</code>.
The implementation can be used with a <code>ConcurrentHashMap</code> as a testing or convenience mechanism.
Alternatively, it can be used with distributed <code>Map</code> implementations with the requirement that the supplied <code>Map</code> must be a non-blocking.</p>
</div>
</div>
<div class="sect2">
<h3 id="api-jdbcoperationssessionrepository"><a class="anchor" href="index.html#api-jdbcoperationssessionrepository"></a>9.11. JdbcOperationsSessionRepository</h3>
<div class="paragraph">
<p><code>JdbcOperationsSessionRepository</code> is a <code>SessionRepository</code> implementation that uses Spring&#8217;s <code>JdbcOperations</code> to store sessions in a relational database.
In a web environment, this is typically used in combination with <code>SessionRepositoryFilter</code>.
Please note that this implementation does not support publishing of session events.</p>
</div>
<div class="sect3">
<h4 id="api-jdbcoperationssessionrepository-new"><a class="anchor" href="index.html#api-jdbcoperationssessionrepository-new"></a>9.11.1. Instantiating a JdbcOperationsSessionRepository</h4>
<div class="paragraph">
<p>A typical example of how to create a new instance can be seen below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">JdbcTemplate jdbcTemplate = new JdbcTemplate();

// ... configure JdbcTemplate ...

PlatformTransactionManager transactionManager = new DataSourceTransactionManager();

// ... configure transactionManager ...

SessionRepository&lt;? extends Session&gt; repository =
		new JdbcOperationsSessionRepository(jdbcTemplate, transactionManager);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For additional information on how to create and configure <code>JdbcTemplate</code> and <code>PlatformTransactionManager</code>, refer to the <a href="https://docs.spring.io/spring/docs/5.0.4.RELEASE/spring-framework-reference/data-access.html">Spring Framework Reference Documentation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-jdbcoperationssessionrepository-config"><a class="anchor" href="index.html#api-jdbcoperationssessionrepository-config"></a>9.11.2. EnableJdbcHttpSession</h4>
<div class="paragraph">
<p>In a web environment, the simplest way to create a new <code>JdbcOperationsSessionRepository</code> is to use <code>@EnableJdbcHttpSession</code>.
Complete example usage can be found in the <a href="index.html#samples">Samples and Guides (Start Here)</a>
You can use the following attributes to customize the configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>tableName</strong> - the name of database table used by Spring Session to store sessions</p>
</li>
<li>
<p><strong>maxInactiveIntervalInSeconds</strong> - the amount of time before the session will expire in seconds</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="custom-lobhandler"><a class="anchor" href="index.html#custom-lobhandler"></a>Custom LobHandler</h5>
<div class="paragraph">
<p>You can customize the BLOB handling by creating a Bean named <code>springSessionLobHandler</code> that implements <code>LobHandler</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="custom-conversionservice"><a class="anchor" href="index.html#custom-conversionservice"></a>Custom ConversionService</h5>
<div class="paragraph">
<p>You can customize the default serialization and deserialization of the session by providing a <code>ConversionService</code> instance.
When working in a typical Spring environment, the default <code>ConversionService</code> Bean (named <code>conversionService</code>) will be automatically picked up and used for serialization and deserialization.
However, you can override the default <code>ConversionService</code> by providing a Bean named <code>springSessionConversionService</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-jdbcoperationssessionrepository-storage"><a class="anchor" href="index.html#api-jdbcoperationssessionrepository-storage"></a>9.11.3. Storage Details</h4>
<div class="paragraph">
<p>By default, this implementation uses <code>SPRING_SESSION</code> and <code>SPRING_SESSION_ATTRIBUTES</code> tables to store sessions.
Note that the table name can be easily customized as already described. In that case the table used to store attributes will be named using the provided table name, suffixed with <code>_ATTRIBUTES</code>.
If further customizations are needed, SQL queries used by the repository can be customized using <code>set*Query</code> setter methods. In this case you need to manually configure the <code>sessionRepository</code> bean.</p>
</div>
<div class="paragraph">
<p>Due to the differences between the various database vendors, especially when it comes to storing binary data, make sure to use SQL script specific to your database.
Scripts for most major database vendors are packaged as <code>org/springframework/session/jdbc/schema-*.sql</code>, where <code>*</code> is the target database type.</p>
</div>
<div class="paragraph">
<p>For example, with PostgreSQL database you would use the following schema script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sql" data-lang="sql">CREATE TABLE SPRING_SESSION (
	PRIMARY_ID CHAR(36) NOT NULL,
	SESSION_ID CHAR(36) NOT NULL,
	CREATION_TIME BIGINT NOT NULL,
	LAST_ACCESS_TIME BIGINT NOT NULL,
	MAX_INACTIVE_INTERVAL INT NOT NULL,
	EXPIRY_TIME BIGINT NOT NULL,
	PRINCIPAL_NAME VARCHAR(100),
	CONSTRAINT SPRING_SESSION_PK PRIMARY KEY (PRIMARY_ID)
);

CREATE UNIQUE INDEX SPRING_SESSION_IX1 ON SPRING_SESSION (SESSION_ID);
CREATE INDEX SPRING_SESSION_IX2 ON SPRING_SESSION (EXPIRY_TIME);
CREATE INDEX SPRING_SESSION_IX3 ON SPRING_SESSION (PRINCIPAL_NAME);

CREATE TABLE SPRING_SESSION_ATTRIBUTES (
	SESSION_PRIMARY_ID CHAR(36) NOT NULL,
	ATTRIBUTE_NAME VARCHAR(200) NOT NULL,
	ATTRIBUTE_BYTES BYTEA NOT NULL,
	CONSTRAINT SPRING_SESSION_ATTRIBUTES_PK PRIMARY KEY (SESSION_PRIMARY_ID, ATTRIBUTE_NAME),
	CONSTRAINT SPRING_SESSION_ATTRIBUTES_FK FOREIGN KEY (SESSION_PRIMARY_ID) REFERENCES SPRING_SESSION(PRIMARY_ID) ON DELETE CASCADE
);

CREATE INDEX SPRING_SESSION_ATTRIBUTES_IX1 ON SPRING_SESSION_ATTRIBUTES (SESSION_PRIMARY_ID);</code></pre>
</div>
</div>
<div class="paragraph">
<p>And with MySQL database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sql" data-lang="sql">CREATE TABLE SPRING_SESSION (
	PRIMARY_ID CHAR(36) NOT NULL,
	SESSION_ID CHAR(36) NOT NULL,
	CREATION_TIME BIGINT NOT NULL,
	LAST_ACCESS_TIME BIGINT NOT NULL,
	MAX_INACTIVE_INTERVAL INT NOT NULL,
	EXPIRY_TIME BIGINT NOT NULL,
	PRINCIPAL_NAME VARCHAR(100),
	CONSTRAINT SPRING_SESSION_PK PRIMARY KEY (PRIMARY_ID)
) ENGINE=InnoDB;

CREATE UNIQUE INDEX SPRING_SESSION_IX1 ON SPRING_SESSION (SESSION_ID);
CREATE INDEX SPRING_SESSION_IX2 ON SPRING_SESSION (EXPIRY_TIME);
CREATE INDEX SPRING_SESSION_IX3 ON SPRING_SESSION (PRINCIPAL_NAME);

CREATE TABLE SPRING_SESSION_ATTRIBUTES (
	SESSION_PRIMARY_ID CHAR(36) NOT NULL,
	ATTRIBUTE_NAME VARCHAR(200) NOT NULL,
	ATTRIBUTE_BYTES BLOB NOT NULL,
	CONSTRAINT SPRING_SESSION_ATTRIBUTES_PK PRIMARY KEY (SESSION_PRIMARY_ID, ATTRIBUTE_NAME),
	CONSTRAINT SPRING_SESSION_ATTRIBUTES_FK FOREIGN KEY (SESSION_PRIMARY_ID) REFERENCES SPRING_SESSION(PRIMARY_ID) ON DELETE CASCADE
) ENGINE=InnoDB;

CREATE INDEX SPRING_SESSION_ATTRIBUTES_IX1 ON SPRING_SESSION_ATTRIBUTES (SESSION_PRIMARY_ID);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="transaction-management"><a class="anchor" href="index.html#transaction-management"></a>9.11.4. Transaction management</h4>
<div class="paragraph">
<p>All JDBC operations in <code>JdbcOperationsSessionRepository</code> are executed in a transactional manner.
Transactions are executed with propagation set to <code>REQUIRES_NEW</code> in order to avoid unexpected behavior due to interference with existing transactions (for example, executing <code>save</code> operation in a thread that already participates in a read-only transaction).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-hazelcastsessionrepository"><a class="anchor" href="index.html#api-hazelcastsessionrepository"></a>9.12. HazelcastSessionRepository</h3>
<div class="paragraph">
<p><code>HazelcastSessionRepository</code> is a <code>SessionRepository</code> implementation that stores sessions in Hazelcast&#8217;s distributed <code>IMap</code>.
In a web environment, this is typically used in combination with <code>SessionRepositoryFilter</code>.</p>
</div>
<div class="sect3">
<h4 id="api-hazelcastsessionrepository-new"><a class="anchor" href="index.html#api-hazelcastsessionrepository-new"></a>9.12.1. Instantiating a HazelcastSessionRepository</h4>
<div class="paragraph">
<p>A typical example of how to create a new instance can be seen below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Config config = new Config();

// ... configure Hazelcast ...

HazelcastInstance hazelcastInstance = Hazelcast.newHazelcastInstance(config);

HazelcastSessionRepository repository =
		new HazelcastSessionRepository(hazelcastInstance);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For additional information on how to create and configure Hazelcast instance, refer to the <a href="http://docs.hazelcast.org/docs/3.9.3/manual/html-single/index.html#hazelcast-configuration">Hazelcast documentation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-enablehazelcasthttpsession"><a class="anchor" href="index.html#api-enablehazelcasthttpsession"></a>9.12.2. EnableHazelcastHttpSession</h4>
<div class="paragraph">
<p>If you wish to use <a href="https://hazelcast.org/">Hazelcast</a> as your backing source for the <code>SessionRepository</code>, then the <code>@EnableHazelcastHttpSession</code> annotation
can be added to an <code>@Configuration</code> class. This extends the functionality provided by the <code>@EnableSpringHttpSession</code> annotation but makes the <code>SessionRepository</code> for you in Hazelcast.
You must provide a single <code>HazelcastInstance</code> bean for the configuration to work.
Complete configuration example can be found in the <a href="index.html#samples">Samples and Guides (Start Here)</a></p>
</div>
</div>
<div class="sect3">
<h4 id="api-enablehazelcasthttpsession-customize"><a class="anchor" href="index.html#api-enablehazelcasthttpsession-customize"></a>9.12.3. Basic Customization</h4>
<div class="paragraph">
<p>You can use the following attributes on <code>@EnableHazelcastHttpSession</code> to customize the configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>maxInactiveIntervalInSeconds</strong> - the amount of time before the session will expire in seconds. Default is 1800 seconds (30 minutes)</p>
</li>
<li>
<p><strong>sessionMapName</strong> - the name of the distributed <code>Map</code> that will be used in Hazelcast to store the session data.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="api-enablehazelcasthttpsession-events"><a class="anchor" href="index.html#api-enablehazelcasthttpsession-events"></a>9.12.4. Session Events</h4>
<div class="paragraph">
<p>Using a <code>MapListener</code> to respond to entries being added, evicted, and removed from the distributed <code>Map</code>, these events will trigger
publishing <code>SessionCreatedEvent</code>, <code>SessionExpiredEvent</code>, and <code>SessionDeletedEvent</code> events respectively using the <code>ApplicationEventPublisher</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-enablehazelcasthttpsession-storage"><a class="anchor" href="index.html#api-enablehazelcasthttpsession-storage"></a>9.12.5. Storage Details</h4>
<div class="paragraph">
<p>Sessions will be stored in a distributed <code>IMap</code> in Hazelcast.
The <code>IMap</code> interface methods will be used to <code>get()</code> and <code>put()</code> Sessions.
Additionally, <code>values()</code> method is used to support <code>FindByIndexNameSessionRepository#findByIndexNameAndIndexValue</code> operation, together with appropriate <code>ValueExtractor</code> that needs to be registered with Hazelcast. Refer to <a href="index.html#samples">Hazelcast Spring Sample</a> for more details on this configuration.
The expiration of a session in the <code>IMap</code> is handled by Hazelcast&#8217;s support for setting the time to live on an entry when it is <code>put()</code> into the <code>IMap</code>. Entries (sessions) that have been idle longer than the time to live will be automatically removed from the <code>IMap</code>.</p>
</div>
<div class="paragraph">
<p>You shouldn&#8217;t need to configure any settings such as <code>max-idle-seconds</code> or <code>time-to-live-seconds</code> for the <code>IMap</code> within the Hazelcast configuration.</p>
</div>
<div class="paragraph">
<p>Note that if you use Hazelcast&#8217;s <code>MapStore</code> to persist your sessions <code>IMap</code> there are some limitations when reloading the sessions from <code>MapStore</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>reload triggers <code>EntryAddedListener</code> which results in <code>SessionCreatedEvent</code> being re-published</p>
</li>
<li>
<p>reload uses default TTL for a given <code>IMap</code> which results in sessions losing their original TTL</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="custom-sessionrepository"><a class="anchor" href="index.html#custom-sessionrepository"></a>10. Custom SessionRepository</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Implementing a custom <a href="index.html#api-sessionrepository"><code>SessionRepository</code></a> API should be a fairly straightforward task.
Coupling the custom implementation with <a href="index.html#api-enablespringhttpsession"><code>@EnableSpringHttpSession</code></a> support allow to easily reuse existing Spring Session configuration facilities and infrastructure.
There are however a couple of aspects that deserve a closer consideration.</p>
</div>
<div class="paragraph">
<p>During a lifecycle of an HTTP request, the <code>HttpSession</code> is typically is persisted to <code>SessionRepository</code> twice.
First to ensure that the session is available to the clients as soon as the client has access to the session ID, and it is also necessary to write after the session is committed because further modifications to the session might be made.
Having this in mind, it is generally recommended for a <code>SessionRepository</code> implementation to keep track of changes to ensure that only deltas are saved.
This is in particular very important in highly concurrent environments, where multiple requests operate on the same <code>HttpSession</code> and therefore cause race conditions, with requests overriding each others changes to session attributes.
All of the <code>SessionRepository</code> implementations provided by Spring Session use the described approach to persisting session changes and can be used for guidance while implementing custom <code>SessionRepository</code>.</p>
</div>
<div class="paragraph">
<p>Note that the same recommendations apply for implementing a custom <a href="index.html#api-reactivesessionrepository"><code>ReactiveSessionRepository</code></a> as well.
Of course, in this case the <a href="index.html#api-enablespringwebsession"><code>@EnableSpringWebSession</code></a> should be used.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="upgrading-2.0"><a class="anchor" href="index.html#upgrading-2.0"></a>11. Upgrading to 2.x</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With the new major release version, the Spring Session team took the opportunity to make some non-passive changes.
The focus of these changes is to improve and harmonize Spring Session&#8217;s APIs, as well as remove the deprecated components.</p>
</div>
<div class="sect2">
<h3 id="baseline-update"><a class="anchor" href="index.html#baseline-update"></a>11.1. Baseline update</h3>
<div class="paragraph">
<p>Spring Session 2.0 requires Java 8 and Spring Framework 5.0 as a baseline, since its entire codebase is now based on Java 8 source code.
Refer to guide for <a href="https://github.com/spring-projects/spring-framework/wiki/Upgrading-to-Spring-Framework-5.x">Upgrading to Spring Framework 5.x</a> for reference on upgrading Spring Framework.</p>
</div>
</div>
<div class="sect2">
<h3 id="replaced-and-removed-modules"><a class="anchor" href="index.html#replaced-and-removed-modules"></a>11.2. Replaced and Removed Modules</h3>
<div class="paragraph">
<p>As a part of the project&#8217;s split the modules, the existing <code>spring-session</code> has been replaced with <code>spring-session-core</code> module.
The <code>spring-session-core</code> module holds only the common set of APIs and components while other modules contain the implementation of appropriate <code>SessionRepository</code> and functionality related to that data store.
This applies to several existing that were previously a simple dependency aggregator helper modules but with new module arrangement actually carry the implementation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Spring Session Data Redis</p>
</li>
<li>
<p>Spring Session JDBC</p>
</li>
<li>
<p>Spring Session Hazelcast</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Also the following modules were removed from the main project repository:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Spring Session Data MongoDB</p>
</li>
<li>
<p>Spring Session Data GemFire</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that these two have moved to separate repositories, and will continue to be available albeit under a changed artifact names:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/spring-projects/spring-session-data-mongodb"><code>spring-session-data-mongodb</code></a></p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-session-data-geode"><code>spring-session-data-geode</code></a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="replaced-and-removed-packages-classes-and-methods"><a class="anchor" href="index.html#replaced-and-removed-packages-classes-and-methods"></a>11.3. Replaced and Removed Packages, Classes and Methods</h3>
<div class="ulist">
<ul>
<li>
<p><code>ExpiringSession</code> API has been merged into <code>Session</code> API</p>
</li>
<li>
<p><code>Session</code> API has been enhanced to make full use of Java 8</p>
</li>
<li>
<p><code>Session</code> API has been extended with <code>changeSessionId</code> support</p>
</li>
<li>
<p><code>SessionRepository</code> API has been updated to better align with Spring Data method naming conventions</p>
</li>
<li>
<p><code>AbstractSessionEvent</code> and its subclasses are no longer constructable without an underlying <code>Session</code> object</p>
</li>
<li>
<p>Redis namespace used by <code>RedisOperationsSessionRepository</code> is now fully configurable, instead of being partial configurable</p>
</li>
<li>
<p>Redis configuration support has been updated to avoid registering a Spring Session specific <code>RedisTemplate</code> bean</p>
</li>
<li>
<p>JDBC configuration support has been updated to avoid registering a Spring Session specific <code>JdbcTemplate</code> bean</p>
</li>
<li>
<p>Previously deprecated classes and methods have been removed across the codebase</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="dropped-support"><a class="anchor" href="index.html#dropped-support"></a>11.4. Dropped Support</h3>
<div class="paragraph">
<p>As a part of the changes to <code>HttpSessionStrategy</code> and it&#8217;s alignment to the counterpart from the reactive world, the support for managing multiple users' sessions in a single browser instance has been removed.
This introduction of new API to replace this functionality in consideration for future releases.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="community"><a class="anchor" href="index.html#community"></a>12. Spring Session Community</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We are glad to consider you a part of our community.
Please find additional information below.</p>
</div>
<div class="sect2">
<h3 id="community-support"><a class="anchor" href="index.html#community-support"></a>12.1. Support</h3>
<div class="paragraph">
<p>You can get help by asking questions on <a href="https://stackoverflow.com/questions/tagged/spring-session">StackOverflow with the tag spring-session</a>.
Similarly we encourage helping others by answering questions on StackOverflow.</p>
</div>
</div>
<div class="sect2">
<h3 id="community-source"><a class="anchor" href="index.html#community-source"></a>12.2. Source Code</h3>
<div class="paragraph">
<p>Our source code can be found on GitHub at <a href="https://github.com/spring-projects/spring-session/" class="bare">https://github.com/spring-projects/spring-session/</a></p>
</div>
</div>
<div class="sect2">
<h3 id="community-issues"><a class="anchor" href="index.html#community-issues"></a>12.3. Issue Tracking</h3>
<div class="paragraph">
<p>We track issues in GitHub issues at <a href="https://github.com/spring-projects/spring-session/issues" class="bare">https://github.com/spring-projects/spring-session/issues</a></p>
</div>
</div>
<div class="sect2">
<h3 id="community-contributing"><a class="anchor" href="index.html#community-contributing"></a>12.4. Contributing</h3>
<div class="paragraph">
<p>We appreciate <a href="https://help.github.com/articles/using-pull-requests/">Pull Requests</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="community-license"><a class="anchor" href="index.html#community-license"></a>12.5. License</h3>
<div class="paragraph">
<p>Spring Session is Open Source software released under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="community-extensions"><a class="anchor" href="index.html#community-extensions"></a>12.6. Community Extensions</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Location</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring Session OrientDB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/maseev/spring-session-orientdb" class="bare">https://github.com/maseev/spring-session-orientdb</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring Session Infinispan</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://infinispan.org/docs/dev/user_guide/user_guide.html#externalizing_session_using_spring_session" class="bare">http://infinispan.org/docs/dev/user_guide/user_guide.html#externalizing_session_using_spring_session</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="minimum-requirements"><a class="anchor" href="index.html#minimum-requirements"></a>13. Minimum Requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The minimum requirements for Spring Session are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java 8+</p>
</li>
<li>
<p>If you are running in a Servlet Container (not required), Servlet 3.1+</p>
</li>
<li>
<p>If you are using other Spring libraries (not required), the minimum required version is Spring 5.0.x.</p>
</li>
<li>
<p><code>@EnableRedisHttpSession</code> requires Redis 2.8+. This is necessary to support <a href="index.html#api-redisoperationssessionrepository-expiration">Session Expiration</a></p>
</li>
<li>
<p><code>@EnableHazelcastHttpSession</code> requires Hazelcast 3.6+. This is necessary to support <a href="index.html#api-enablehazelcasthttpsession-storage"><code>FindByIndexNameSessionRepository</code></a></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>At its core Spring Session only has a required dependency on <code>spring-jcl</code>.
For an example of using Spring Session without any other Spring dependencies, refer to the <a href="index.html#samples">hazelcast sample</a> application.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 2.0.2.RELEASE<br>
Last updated 2018-01-12 12:41:03 +00:00
</div>
</div>
<link rel="stylesheet" href="../../../../../../cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script data-cfasync="false" src="../../../../../cdn-cgi/scripts/d07b1474/cloudflare-static/email-decode.min.js"></script><script src="../../../../../../cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
<script>prettyPrint()</script>
<script>if(window.parent==window){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-2728886-23','auto',{'siteSpeedSampleRate':100});ga('send','pageview');}</script></body>
</html>