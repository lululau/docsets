<!DOCTYPE html>

<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <title>执行normal! / Learn Vimscript the Hard Way</title>
        <meta name="description" content="">
        <meta name="author" content="Steve Losh">
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

        <link href="../static/styles/skeleton/base.css" rel="stylesheet" type="text/css" />
        <link href="../static/styles/skeleton/skeleton.css" rel="stylesheet" type="text/css" />
        <link href="../static/styles/skeleton/layout.css" rel="stylesheet" type="text/css" />

        <link href="../static/styles/tango.css" rel="stylesheet" type="text/css" />
        <link href="../static/styles/style.less" rel="stylesheet/less" type="text/css" />

        <script type="text/javascript" src="../static/scripts/less.js"></script>
    </head>

    <body class="">
        <div class="container">
            <header class="sixteen columns">
                <h1><a href="../index.html"></a></h1>
            </header>

            

    <section class="content twelve columns offset-by-one">
        <div> 
<h1 id="normal">执行normal!</h1>
<p>既然已经学了<code>execute</code>和<code>normal!</code>，我们就可以深入探讨一个Vimscript惯用法。
执行下面的命令：</p>
<pre class="codehilite"><code class="language-vim">:execute "normal! gg/foo\&lt;cr&gt;dd"</code></pre>


<p>这将移动到文件的开头，查找<code>foo</code>的首次出现的地方，并删掉那一行。</p>
<p>之前我们尝试过用<code>normal!</code>来执行一个搜索命令却无法输入必须的回车来开始进行搜索。
结合<code>execute</code>和<code>normal!</code>将解决这个问题。</p>
<p><code>execute</code>允许你创建命令，因而你能够使用Vim普通的转义字符串来生成你需要的"打不出"的字符。
尝试下面的命令：</p>
<pre class="codehilite"><code class="language-vim">:execute "normal! mqA;\&lt;esc&gt;`q"</code></pre>


<p>这个命令做了什么？让我们掰开来讲：</p>
<ul><li><code>:execute "normal! ..."</code>：执行命令序列，一如它们是在normal模式下输入的，忽略所有映射，
  并替换转义字符串。</li>
<li><code>mq</code>：保存当前位置到标记"q"。</li>
<li><code>A</code>：移动到当前行的末尾并在最后一个字符后进入insert模式。</li>
<li><code>;</code>：我们现在位于insert模式，所以仅仅是写入了一个";"。</li>
<li><code>\&lt;esc&gt;</code>：这是一个表示Esc键的转义字符串序列，把我们带离insert模式。</li>
<li><code>`q</code>：回到标记"q"所在的位置。</li>
</ul><p>看上去有点绕，不过它真的很有用：它在当前行的末尾补上一个分号并保持光标不动。
在写Javascript，C或其他以分号作为语句分隔符的语言时，一旦忘记加上分号，这样的映射将助你一臂之力。</p>
<h2 id="_1">练习</h2>
<p>重读<code>:help expr-quote</code>(你之前应该看过)来提醒你怎么用<code>execute</code>通过转义字符串传递特殊字符给<code>normal!</code>。</p>
<p>在翻开下一章之前，放下本书休息一下。吃一个三明治或喝一杯咖啡(译注：或者茶！)，
喂一下你的宠物——如果你有的话。</p></div>

        <div class="prevnext">
            
                <a class="prev" href="29.html">&laquo; Previous</a>
            
            
                <a class="next" href="31.html">Next &raquo;</a>
            
        </div>
    </section>


            <footer class="sixteen columns">
                Made by <a href="30.html"></a>.

                <a href="../license.html">License</a>.

                Built with
                <a href="http://bitbucket.org/sjl/bookmarkdown/">Bookmarkdown</a>.
            </footer>
        </div>

        

        
    </body>
</html>